<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.287">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Wang">

<title>Macroeconometrics Research Report - Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#acf-and-pacf-plot" id="toc-acf-and-pacf-plot" class="nav-link" data-scroll-target="#acf-and-pacf-plot">ACF and PACF plot</a></li>
  <li><a href="#augmented-dickey-fuller-test" id="toc-augmented-dickey-fuller-test" class="nav-link" data-scroll-target="#augmented-dickey-fuller-test">Augmented Dickey-Fuller test</a>
  <ul class="collapse">
  <li><a href="#level" id="toc-level" class="nav-link" data-scroll-target="#level">Level</a></li>
  <li><a href="#first-difference" id="toc-first-difference" class="nav-link" data-scroll-target="#first-difference">First difference</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a>
  <ul class="collapse">
  <li><a href="#specification" id="toc-specification" class="nav-link" data-scroll-target="#specification">Specification</a>
  <ul class="collapse">
  <li><a href="#structural-form" id="toc-structural-form" class="nav-link" data-scroll-target="#structural-form">Structural form</a></li>
  <li><a href="#reduced-form" id="toc-reduced-form" class="nav-link" data-scroll-target="#reduced-form">Reduced form</a></li>
  <li><a href="#orthogonal-reduced-form-parameterization" id="toc-orthogonal-reduced-form-parameterization" class="nav-link" data-scroll-target="#orthogonal-reduced-form-parameterization">Orthogonal reduced-form parameterization</a></li>
  </ul></li>
  <li><a href="#algorithm" id="toc-algorithm" class="nav-link" data-scroll-target="#algorithm">Algorithm</a>
  <ul class="collapse">
  <li><a href="#reduced-form-1" id="toc-reduced-form-1" class="nav-link" data-scroll-target="#reduced-form-1">Reduced form</a></li>
  <li><a href="#structural-form-1" id="toc-structural-form-1" class="nav-link" data-scroll-target="#structural-form-1">Structural form</a></li>
  <li><a href="#implementations" id="toc-implementations" class="nav-link" data-scroll-target="#implementations">Implementations</a></li>
  <li><a href="#extension" id="toc-extension" class="nav-link" data-scroll-target="#extension">Extension</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul class="collapse">
  <li><a href="#reduced-form-2" id="toc-reduced-form-2" class="nav-link" data-scroll-target="#reduced-form-2">Reduced form</a></li>
  <li><a href="#structural-form-2" id="toc-structural-form-2" class="nav-link" data-scroll-target="#structural-form-2">Structural form</a></li>
  </ul></li>
  <li><a href="#identification" id="toc-identification" class="nav-link" data-scroll-target="#identification">Identification</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#irf" id="toc-irf" class="nav-link" data-scroll-target="#irf">IRF</a></li>
  <li><a href="#fevd" id="toc-fevd" class="nav-link" data-scroll-target="#fevd">FEVD</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#us-data" id="toc-us-data" class="nav-link" data-scroll-target="#us-data">US data</a>
  <ul class="collapse">
  <li><a href="#irf-1" id="toc-irf-1" class="nav-link" data-scroll-target="#irf-1">IRF</a></li>
  <li><a href="#fevd-1" id="toc-fevd-1" class="nav-link" data-scroll-target="#fevd-1">FEVD</a></li>
  </ul></li>
  <li><a href="#australian-data" id="toc-australian-data" class="nav-link" data-scroll-target="#australian-data">Australian data</a>
  <ul class="collapse">
  <li><a href="#history" id="toc-history" class="nav-link" data-scroll-target="#history">History</a></li>
  <li><a href="#irf-2" id="toc-irf-2" class="nav-link" data-scroll-target="#irf-2">IRF</a></li>
  <li><a href="#fevd-2" id="toc-fevd-2" class="nav-link" data-scroll-target="#fevd-2">FEVD</a></li>
  </ul></li>
  <li><a href="#extension-1" id="toc-extension-1" class="nav-link" data-scroll-target="#extension-1">Extension</a>
  <ul class="collapse">
  <li><a href="#history-1" id="toc-history-1" class="nav-link" data-scroll-target="#history-1">History</a></li>
  <li><a href="#irf-3" id="toc-irf-3" class="nav-link" data-scroll-target="#irf-3">IRF</a></li>
  <li><a href="#fevd-3" id="toc-fevd-3" class="nav-link" data-scroll-target="#fevd-3">FEVD</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adam Wang </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<!-- latex shortcuts -->
<!-- do not show warnings and run code when testing -->
<blockquote class="blockquote">
<p><strong>Abstract.</strong> This article investigates the effects of optimism shocks on the Australian economy using a Bayesian Structural Vector Autoregression (BSVAR) model. We implement the sign and zero restrictions algorithm proposed by <span class="citation" data-cites="arias2018inference">Arias, Rubio-Ramı́rez, and Waggoner (<a href="#ref-arias2018inference" role="doc-biblioref">2018</a>)</span> to identify the optimism shock. Impulse response functions (IRF) and forecast error variance decomposition (FEVD) are used to analyse the effects of the optimism shock on five key macroeconomic variables: productivity, stock prices, consumption, real interest rate and hours worked.</p>
<p><strong>Keywords.</strong> Bayesian Structural VAR, sign restrictions, zero restrictions, optimism shock</p>
</blockquote>
<!-- [Replication Package](https://www.econometricsociety.org/publications/econometrica/2018/03/01/inference-based-structural-vector-autoregressions-identified) -->
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p><strong>Objective</strong>: The goal of this research project is to implement the sign and zero restrictions algorithm proposed by <span class="citation" data-cites="arias2018inference">Arias, Rubio-Ramı́rez, and Waggoner (<a href="#ref-arias2018inference" role="doc-biblioref">2018</a>)</span> in the <a href="https://github.com/bsvars/bsvarSIGNs">bsvarSIGNs</a> package, and apply it to analyse the optimism shock to Australian economy.</p>
<p><strong>Question</strong>: Does optimism shocks drive the business cycles in Australian economy?</p>
<p><strong>Motivation</strong>: In macroeconomics, there has been a longstanding belief that fluctuations in business cycles can be largely attributed to episodes of optimism and pessimism. An optimism shock is defined as a positive shock to stock prices that does not affect productivity. Using a penalty function approach (PFA)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, <span class="citation" data-cites="beaudry2011mood">Beaudry, Nam, and Wang (<a href="#ref-beaudry2011mood" role="doc-biblioref">2011</a>)</span> finds significant evidence that optimism shocks are a key driver of business cycles in the United States as it creates a simultaneous boom in consumption and hours worked. But, <span class="citation" data-cites="arias2018inference">Arias, Rubio-Ramı́rez, and Waggoner (<a href="#ref-arias2018inference" role="doc-biblioref">2018</a>)</span> argue that PFA imposes additional restrictions, and they find less significant results using an importance sampler algorithm. This research project aims to extend the analysis to the Australian economy by implementing the importance sampler algorithm, and compare the results with United-States data.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<!-- load data -->
<!-- concat datasets -->
<p>All data are collected from the Reserve Bank of Australia (RBA), the Australian Bureau of Statistics (ABS) and Yahoo Finance. The sample period covers 1994 Q3 to 2023 Q4. Following <span class="citation" data-cites="beaudry2011mood">Beaudry, Nam, and Wang (<a href="#ref-beaudry2011mood" role="doc-biblioref">2011</a>)</span>, we select the following five variables for our analysis</p>
<ul>
<li><strong>Productivity</strong>: non-farm labour productivity per hour (source: RBA, series ID GNFPROSQI).</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="quarto-discovered-preview-image img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Productivity</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Stock prices</strong>: end-of-period ASX 200 index (source: Yahoo Finance, ticker symbol ^AXJO), divided by the consumer price index.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Stock prices</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Consumption</strong>: retail turnover (source: ABS, series ID A3348585R), divided by the consumer price index.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Consumption</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Real interest rate</strong>: over-night cash rate nets inflation (source: RBA, series ID FIRMMCRI and GCPIAGSAQP).</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Real interest rate</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Hours worked</strong>: total hours worked (source: ABS, series ID A85389611R).</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Hours worked</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The first two variables (productivity and stock prices) are chosen to identify the optimism shock, the last three variables (consumption, real interest rate and hours worked) are chosen to capture the business cycle dynamics as in standard macroeconomic theory.</p>
<p>To capture multiplicative relationships in macroeconomic time series and percentage change interpretation, all variables are log transformed (except for real interest rate). A preview of first 6 rows of the concatenated dataset is shown below.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">date</th>
<th style="text-align: center;">productivity</th>
<th style="text-align: center;">stock_prices</th>
<th style="text-align: center;">consumption</th>
<th style="text-align: center;">real_interest_rate</th>
<th style="text-align: center;">hours_worked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Sep 1994</td>
<td style="text-align: center;">4.2297</td>
<td style="text-align: center;">3.4527</td>
<td style="text-align: center;">4.9278</td>
<td style="text-align: center;">4.842</td>
<td style="text-align: center;">6.0222</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dec 1994</td>
<td style="text-align: center;">4.2384</td>
<td style="text-align: center;">3.3870</td>
<td style="text-align: center;">4.9191</td>
<td style="text-align: center;">5.961</td>
<td style="text-align: center;">6.0143</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Mar 1995</td>
<td style="text-align: center;">4.2283</td>
<td style="text-align: center;">3.3764</td>
<td style="text-align: center;">4.9315</td>
<td style="text-align: center;">5.892</td>
<td style="text-align: center;">6.0171</td>
</tr>
<tr class="even">
<td style="text-align: center;">Jun 1995</td>
<td style="text-align: center;">4.2136</td>
<td style="text-align: center;">3.4216</td>
<td style="text-align: center;">4.9487</td>
<td style="text-align: center;">6.209</td>
<td style="text-align: center;">6.0220</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Sep 1995</td>
<td style="text-align: center;">4.2327</td>
<td style="text-align: center;">3.4635</td>
<td style="text-align: center;">4.9500</td>
<td style="text-align: center;">6.293</td>
<td style="text-align: center;">6.0199</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dec 1995</td>
<td style="text-align: center;">4.2297</td>
<td style="text-align: center;">3.4968</td>
<td style="text-align: center;">4.9610</td>
<td style="text-align: center;">6.708</td>
<td style="text-align: center;">6.0164</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="acf-and-pacf-plot" class="level2">
<h2 class="anchored" data-anchor-id="acf-and-pacf-plot">ACF and PACF plot</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-acf-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-acf-plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: ACF Plots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The autocorrelation function (ACF) plot shows all variables have a consistent pattern of autocorrelation, this suggests that the time series are non-stationary. Stationarity is formally tested using the Augmented Dickey-Fuller test in the next section.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pacf-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-pacf-plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: PACF Plots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The partial autocorrelation function (PACF) plot shows that the partial autocorrelation of all variables is significant at lag 1, real interest rate is also significant at lag 2. Therefore, choosing a lag length for the VAR model greater than or equal to 2 is reasonable, following convention for quarterly data, we will adopt a lag length of 4 for the VAR model.</p>
</section>
<section id="augmented-dickey-fuller-test" class="level2">
<h2 class="anchored" data-anchor-id="augmented-dickey-fuller-test">Augmented Dickey-Fuller test</h2>
<section id="level" class="level3">
<h3 class="anchored" data-anchor-id="level">Level</h3>
<p>All five variables are non-stationary at 5% significance level base on the Augmented Dickey-Fuller test.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">p_value</th>
<th style="text-align: right;">non_stationary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">productivity</td>
<td style="text-align: right;">0.8372</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">stock_prices</td>
<td style="text-align: right;">0.1728</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumption</td>
<td style="text-align: right;">0.6167</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">real_interest_rate</td>
<td style="text-align: right;">0.3705</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hours_worked</td>
<td style="text-align: right;">0.0657</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="first-difference" class="level3">
<h3 class="anchored" data-anchor-id="first-difference">First difference</h3>
<p>Applying Augmented Dickey-Fuller test to the first difference of the variables, we find that all variables are stationary at 5% significance level. Therefore, all variables are integrated of order one <span class="math inline">\(I(1)\)</span> and it is reasonable to put them in a VAR system without further transformation.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">p_value</th>
<th style="text-align: right;">non_stationary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">productivity</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">stock_prices</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumption</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">real_interest_rate</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hours_worked</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="model" class="level1">
<h1>Model</h1>
<section id="specification" class="level2">
<h2 class="anchored" data-anchor-id="specification">Specification</h2>
<p>Adopting notations from <span class="citation" data-cites="rubio2010structural">Rubio-Ramirez, Waggoner, and Zha (<a href="#ref-rubio2010structural" role="doc-biblioref">2010</a>)</span>, the SVAR model is specified as follows.</p>
<p>The endogenous variables are</p>
<p><span class="math display">\[
\mathbf{y}_t = [\text{productivity}_t,\ \text{stock prices}_t,\ \text{consumption}_t,\ \text{real interest rate}_t,\ \text{hours worked}_t]'
\]</span></p>
<section id="structural-form" class="level3">
<h3 class="anchored" data-anchor-id="structural-form">Structural form</h3>
<p><span class="math display">\[
\begin{align*}
\mathbf{y}_t' \mathbf{A}_0 &amp;= \sum_{l=1}^{p} \mathbf{y}_{t-l}'\mathbf{A}_l + \mathbf{c} + \boldsymbol{\varepsilon}_t' \\
\boldsymbol{\varepsilon}_t | \mathbf{Y}_{t-1} &amp;\overset{\text{iid}}{\sim} \mathcal{N}_N(\mathbf{0}, \mathbf{I})
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{y}_t\)</span> is an <span class="math inline">\(N\times1\)</span> vector of endogenous variables, <span class="math inline">\(\boldsymbol{\varepsilon}_t\)</span> is an <span class="math inline">\(N\times1\)</span> vector of exogenous structural shocks, <span class="math inline">\(\mathbf{A}_l\)</span> is an <span class="math inline">\(N\times N\)</span> matrix of parameters with <span class="math inline">\(\mathbf{A}_0\)</span> invertible, <span class="math inline">\(\mathbf{c}\)</span> is an <span class="math inline">\(1\times N\)</span> vector of parameters, and <span class="math inline">\(p\)</span> is the lag length, and <span class="math inline">\(T\)</span> is the sample size. This can be compactly written as</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{y}_t' \mathbf{A}_0 &amp;= \mathbf{x}_t' \mathbf{A}_+ + \boldsymbol{\varepsilon}_t'
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{A}_+ = [\mathbf{A}_1'\ \cdots\ \mathbf{A}_p'\ \hspace{4mm}\mathbf{c}']\)</span> and <span class="math inline">\(\mathbf{x}_t = [\mathbf{y}_{t-1}'\ \cdots\ \mathbf{y}_{t-p}'\hspace{4mm}\ 1]\)</span>. The dimension of <span class="math inline">\(\mathbf{A}_+\)</span> is <span class="math inline">\(K\times N\)</span> where <span class="math inline">\(K=Np+1\)</span>.</p>
<p>In matrix form,</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{Y} \mathbf{A}_0 &amp;= \mathbf{X} \mathbf{A}_+ + \boldsymbol{\varepsilon}\\
\boldsymbol{\varepsilon}| \mathbf{X} &amp;\sim \mathcal{MN}_{T\times N}(\mathbf{0}, \mathbf{I}_N, \mathbf{I}_T)
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{Y} = [\mathbf{y}_1\ \cdots\ \mathbf{y}_T]'\)</span>,&nbsp;<span class="math inline">\(\mathbf{X} = [\mathbf{x}_1\ \cdots\ \mathbf{x}_T]'\)</span>, and <span class="math inline">\(\boldsymbol{\varepsilon}= [\boldsymbol{\varepsilon}_1\ \cdots\ \boldsymbol{\varepsilon}_T]'\)</span>.</p>
<p>The matrices <span class="math inline">\(\mathbf{A}_0\)</span> and <span class="math inline">\(\mathbf{A}_+\)</span> are structural parameters.</p>
</section>
<section id="reduced-form" class="level3">
<h3 class="anchored" data-anchor-id="reduced-form">Reduced form</h3>
<p><span class="math display">\[
\begin{align*}
\mathbf{y}_t' &amp;= \mathbf{x}_t' \mathbf{B} + \mathbf{u}_t' \\
\mathbf{u}_t | \mathbf{Y}_{t-1} &amp;\overset{\text{iid}}{\sim} \mathcal{N}_N(\mathbf{0}, \mathbf{\Sigma})
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{B} = \mathbf{A}_ + \mathbf{A}_0^{-1},\ \mathbf{u}_t' = \boldsymbol{\varepsilon}_t' \mathbf{A}_0^{-1}\)</span>, and</p>
<p><span class="math display">\[
\mathbf{\Sigma }= \mathbb{E}[\mathbf{u}_t\mathbf{u}_t'] = (\mathbf{A}_0^{-1})' (\mathbf{A}_0^{-1}) = (\mathbf{A}_0 \mathbf{A}_0')^{-1}
\]</span></p>
<p>In matrix form,</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{Y} &amp;= \mathbf{X} \mathbf{B} + \mathbf{u} \\
\mathbf{u} | \mathbf{X} &amp;\sim \mathcal{MN}_{T\times n}(\mathbf{0}, \mathbf{\Sigma}, \mathbf{I}_T)
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{u} = [\mathbf{u}_1\ \cdots\ \mathbf{u}_T]'\)</span>.</p>
<p>The matrices <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{\Sigma}\)</span> are reduced-form parameters.</p>
</section>
<section id="orthogonal-reduced-form-parameterization" class="level3">
<h3 class="anchored" data-anchor-id="orthogonal-reduced-form-parameterization">Orthogonal reduced-form parameterization</h3>
<p>Since SVAR model are identified up to a rotation matrix <span class="math inline">\(\mathbf{Q}\)</span>, we can explicitly specified the reduced-form model as</p>
<p><span class="math display">\[
\mathbf{y}_t' = \mathbf{x}_t' \mathbf{B} + \boldsymbol{\varepsilon}_t' \mathbf{Q}' h(\mathbf{\Sigma})
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{Q}'h(\mathbf{\Sigma}) = \mathbf{A}_0^{-1}\)</span> or <span class="math inline">\(\mathbf{Q}=h(\mathbf{\Sigma}) \mathbf{A}_0\)</span>, and <span class="math inline">\(h\)</span> is some differentiable decomposition, one specific choice is the upper triangular Cholesky decomposition.</p>
<p>Then, we can define a mapping <span class="math inline">\(f_h\)</span> between the reduced-form parameters <span class="math inline">\((\mathbf{B}, \mathbf{\Sigma}, \mathbf{Q})\)</span> and structural-form parameters <span class="math inline">\((\mathbf{A}_0, \mathbf{A}_+)\)</span> as</p>
<p><span class="math display">\[
\begin{align*}
f_h(\mathbf{A}_0, \mathbf{A}_+) &amp;= (
  \underbrace{\mathbf{A}_+ \mathbf{A}_0^{-1}}_\mathbf{B},
  \underbrace{(\mathbf{A}_0 \mathbf{A}_0')^{-1}}_{\mathbf{\Sigma}},
  \underbrace{h((\mathbf{A}_0 \mathbf{A}_0')^{-1}) \mathbf{A}_0}_\mathbf{Q}
  ) \\
f_h^{-1}(\mathbf{B}, \mathbf{\Sigma}, \mathbf{Q}) &amp;= (
  \underbrace{h(\mathbf{\Sigma})^{-1} \mathbf{Q}}_{\mathbf{A}_0},
  \underbrace{\mathbf{B} h(\mathbf{\Sigma})^{-1} \mathbf{Q}}_{\mathbf{A}_+}
  )
\end{align*}
\]</span></p>
</section>
</section>
<section id="algorithm" class="level2">
<h2 class="anchored" data-anchor-id="algorithm">Algorithm</h2>
<section id="reduced-form-1" class="level3">
<h3 class="anchored" data-anchor-id="reduced-form-1">Reduced form</h3>
<p>The first step is to sample the reduced-form parameters (<span class="math inline">\(\mathbf{B}\)</span>, <span class="math inline">\(\mathbf{\Sigma}\)</span>). Adopting the conjugate Normal-Inverse-Wishart prior,</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}|\mathbf{\Sigma }&amp;\sim \mathcal{MN}_{K\times N}(\underline{\mathbf{B}}, \underline{\mathbf{V}},\mathbf{\Sigma}) \\
\mathbf{\Sigma }&amp;\sim \mathcal{IW}_N(\underline{\mathbf{S}}, \underline{\nu})
\end{align*}
\]</span></p>
<p>and let</p>
<p><span class="math display">\[
\begin{align*}
\hat{\mathbf{B}} &amp;= (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{Y} \\
\mathbf{R} &amp;= (\mathbf{Y}-\mathbf{X}\hat{\mathbf{B}})'(\mathbf{Y}-\mathbf{X}\hat{\mathbf{B}})
\end{align*}
\]</span></p>
<p>the conjugate posterior distribution can be derived from</p>
<p><span class="math display">\[\begin{align*}
p(\mathbf{B},\mathbf{\Sigma}|\mathbf{Y})

&amp;\propto |\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2}\text{tr}\left[ \mathbf{\Sigma}^{-1}(\mathbf{Y}-\mathbf{X}\mathbf{B})'(\mathbf{Y}-\mathbf{X}\mathbf{B}) \right] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2}\text{tr}[\mathbf{\Sigma}^{-1}(\mathbf{B}-\underline{\mathbf{B}})'\underline{\mathbf{V}}^{-1}(\mathbf{B}-\underline{\mathbf{B}})] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-(\underline\nu+N+1)/2}\exp\left\{ -\frac{1}{2} \text{tr}(\underline{\mathbf{S}}\mathbf{\Sigma}^{-1}) \right\} \\

&amp;\propto |\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2}\text{tr}\left[ \left( \mathbf{R}+(\mathbf{B}-\hat{\mathbf{B}})'\mathbf{X}'\mathbf{X}(\mathbf{B}-\hat{\mathbf{B}}) \right) \mathbf{\Sigma}^{-1} \right] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2}\text{tr}[(\mathbf{B}-\underline{\mathbf{B}})'\underline{\mathbf{V}}^{-1}(\mathbf{B}-\underline{\mathbf{B}})\mathbf{\Sigma}^{-1}] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-(\underline\nu+N+1)/2}\exp\left\{ -\frac{1}{2} \text{tr}(\underline{\mathbf{S}}\mathbf{\Sigma}^{-1}) \right\} \\

&amp;\propto |\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2} \text{tr}\left[ \left( (\mathbf{B}-\hat{\mathbf{B}})'\mathbf{X}'\mathbf{X}(\mathbf{B}-\hat{\mathbf{B}})+(\mathbf{B}-\underline{\mathbf{B}})'\underline{\mathbf{V}}^{-1}(\mathbf{B}-\underline{\mathbf{B}}) \right) \mathbf{\Sigma}^{-1} \right] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-(\underline\nu+T+N+1)/2}\exp\left\{ -\frac{1}{2}\text{tr}\left[ (\mathbf{R}+\underline{\mathbf{S}})\mathbf{\Sigma}^{-1} \right] \right\} \\

&amp;=|\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2} \text{tr}\left[ (\mathbf{B}-\overline{\mathbf{B}})'\overline{\mathbf{V}}^{-1}(\mathbf{B}-\overline{\mathbf{B}}) \mathbf{\Sigma}^{-1} \right] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-(\underline\nu+T+N+1)/2}\exp\left\{ -\frac{1}{2}\text{tr}\left[ (\mathbf{R}+\underline{\mathbf{S}}+\hat{\mathbf{B}}'\mathbf{X}'\mathbf{X}\hat{\mathbf{B}}+\underline{\mathbf{B}}'\underline{\mathbf{V}}^{-1}\underline{\mathbf{B}}-\overline{\mathbf{B}}'\overline{\mathbf{V}}^{-1}\overline{\mathbf{B}})\mathbf{\Sigma}^{-1} \right] \right\} \\

&amp;=|\mathbf{\Sigma}|^{-T/2}\exp\left\{ -\frac{1}{2} \text{tr}\left[ (\mathbf{B}-\overline{\mathbf{B}})'\overline{\mathbf{V}}^{-1}(\mathbf{B}-\overline{\mathbf{B}}) \mathbf{\Sigma}^{-1} \right] \right\} \\
&amp;\quad\times |\mathbf{\Sigma}|^{-(\underline\nu+T+N+1)/2}\exp\left\{ -\frac{1}{2}\text{tr}\left[ (\mathbf{Y}'\mathbf{Y}+\underline{\mathbf{S}}+\underline{\mathbf{B}}'\underline{\mathbf{V}}^{-1}\underline{\mathbf{B}}-\overline{\mathbf{B}}'\overline{\mathbf{V}}\overline{\mathbf{B}})\mathbf{\Sigma}^{-1} \right] \right\} \\

&amp;=p(\mathbf{B}|\mathbf{\Sigma},\mathbf{Y})\times p(\mathbf{\Sigma}|\mathbf{Y})
\end{align*}\]</span></p>
<p>Therefore, the posterior distribution of the reduced-form parameters is given by</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}|\mathbf{\Sigma},\mathbf{Y} &amp;\sim \mathcal{MN}_{K\times N}(\overline{\mathbf{B}}, \overline{\mathbf{V}},\mathbf{\Sigma}) \\
\mathbf{\Sigma}|\mathbf{Y} &amp;\sim \mathcal{IW}_N(\overline{\mathbf{S}}, \overline{\nu})
\end{align*}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{align*}
\overline{\mathbf{B}} &amp;= \overline{\mathbf{V}}(\mathbf{X}'\mathbf{Y}+\underline{\mathbf{V}}^{-1}\underline{\mathbf{B}}) \\
\overline{\mathbf{V}} &amp;= (\mathbf{X}'\mathbf{X}+\underline{\mathbf{V}}^{-1})^{-1} \\
\overline{\mathbf{S}} &amp;= \underline{\mathbf{S}}+\mathbf{Y}'\mathbf{Y}+\underline{\mathbf{B}}'\underline{\mathbf{V}}^{-1}\underline{\mathbf{B}}-\overline{\mathbf{B}}'\overline{\mathbf{V}}^{-1}\overline{\mathbf{B}} \\
\overline{\nu} &amp;= \underline{\nu}+T
\end{align*}
\]</span></p>
</section>
<section id="structural-form-1" class="level3">
<h3 class="anchored" data-anchor-id="structural-form-1">Structural form</h3>
<p>To perform zero and sign restrictions, we need an algorithm to sample from the posterior distribution of the structural parameters (<span class="math inline">\(\mathbf{A}_0\)</span>, <span class="math inline">\(\mathbf{A}_+\)</span>) conditional on the zero and sign restrictions.</p>
<p>However, the set of structural parameters satisfying the zero restrictions is of Lebesgue measure zero in the set of all structural parameters (akin to <span class="math inline">\(\mathbb{P}(X=x)=0\)</span> for continuous <span class="math inline">\(X\)</span>). Luckily, we can sample the set of structural parameters satisfying the sign restrictions conditional on satisfying the zero restrictions.</p>
<p>Here is a high level outline of the algorithm proposed by <span class="citation" data-cites="arias2018inference">Arias, Rubio-Ramı́rez, and Waggoner (<a href="#ref-arias2018inference" role="doc-biblioref">2018</a>)</span>:</p>
<ol type="1">
<li>Sample reduced-form parameters (<span class="math inline">\(\mathbf{B}\)</span>, <span class="math inline">\(\mathbf{\Sigma}\)</span>, <span class="math inline">\(\mathbf{Q}\)</span>) conditional on the zero restrictions.</li>
<li>Set <span class="math inline">\((\mathbf{A}_0, \mathbf{A}_+) = f_h^{-1}(\mathbf{B}, \mathbf{\Sigma}, \mathbf{Q})\)</span>.</li>
<li>If the sign restrictions are satisfied, keep <span class="math inline">\((\mathbf{A}_0, \mathbf{A}_+)\)</span> and compute an importance weight, otherwise discard.</li>
<li>Repeat steps 1-3 until the desired number of samples is obtained.</li>
<li>Resample with replacement using the importance weights.</li>
</ol>
<p>Where step 5 (importance sampling) is needed to manipulate the density induced by step 1 to the desired Nomral-Generalized-Normal posterior density <span class="math inline">\(\mathcal{NGN}\)</span>.</p>
<p>To be explicit, starting with a Uniform-Normal-Inverse-Wishart <span class="math inline">\(\mathcal{UNIW}\)</span> prior distribution, the importance weight in step 3 is given by (posterior condition on <span class="math inline">\(\mathbf{Y}\)</span> is dropped for brevity):</p>
<p><span class="math display">\[
\begin{align*}
\frac{\mathcal{NGN}(\mathbf{A}_0,\mathbf{A}_+|\mathcal Z, \mathcal S)}{\mathcal{UNIW}(\mathbf{B},\mathbf{\Sigma},\mathbf{Q})v_{(g\circ f_h)|\mathcal Z}(\mathbf{A}_0,\mathbf{A}_+)}
&amp;=\frac{\mathcal{UNIW}(\mathbf{B},\mathbf{\Sigma},\mathbf{Q}|\mathcal Z, \mathcal S)v_{f_h}(\mathbf{A}_0,\mathbf{A}_+)}{\mathcal{UNIW}(\mathbf{B},\mathbf{\Sigma},\mathbf{Q})v_{(g\circ f_h)|\mathcal Z}(\mathbf{A}_0,\mathbf{A}_+)}\\
&amp;\propto\frac{|\text{det}(\mathbf{A}_0)|^{-(2N+K+1)}}{v_{(g\circ f_h)|\mathcal Z}(\mathbf{A}_0,\mathbf{A}_+)}
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\mathcal Z\)</span> denotes zero restrictions and <span class="math inline">\(\mathcal S\)</span> denotes sign restrictions. The numerator is the target density, and the denominator is the proposal density from steps 1-2.</p>
</section>
<section id="implementations" class="level3">
<h3 class="anchored" data-anchor-id="implementations">Implementations</h3>
<p>For computational efficiency, main functions in the <code>bsvarSIGNs</code> package are written in C++. The first function is compute posterior parameters as derived above.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Rcpp<span class="op">::</span>List niw_cpp<span class="op">(</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span> Y<span class="op">,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span> X<span class="op">,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> Rcpp<span class="op">::</span>List prior</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="dt">int</span> T  <span class="op">=</span> Y<span class="op">.</span>n_rows<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  mat prior_B  <span class="op">=</span> as<span class="op">&lt;</span>mat<span class="op">&gt;(</span>prior<span class="op">[</span><span class="st">"B"</span><span class="op">]);</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  mat prior_V  <span class="op">=</span> as<span class="op">&lt;</span>mat<span class="op">&gt;(</span>prior<span class="op">[</span><span class="st">"V"</span><span class="op">]);</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  mat prior_S  <span class="op">=</span> as<span class="op">&lt;</span>mat<span class="op">&gt;(</span>prior<span class="op">[</span><span class="st">"S"</span><span class="op">]);</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> prior_nu <span class="op">=</span> as<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>prior<span class="op">[</span><span class="st">"nu"</span><span class="op">]);</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// analytic solutions</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  mat prior_V_inv <span class="op">=</span> inv_sympd<span class="op">(</span>prior_V<span class="op">);</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  mat post_V_inv  <span class="op">=</span> prior_V_inv <span class="op">+</span> X<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> X<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  mat post_V      <span class="op">=</span> inv_sympd<span class="op">(</span>post_V_inv<span class="op">);</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  mat post_B      <span class="op">=</span> post_V <span class="op">*</span> <span class="op">(</span>X<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> Y <span class="op">+</span> prior_V_inv <span class="op">*</span> prior_B<span class="op">);</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// marginal posterior of Sigma</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  mat post_S  <span class="op">=</span> prior_S <span class="op">+</span> Y<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> Y <span class="op">+</span> prior_B<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> prior_V_inv <span class="op">*</span> prior_B <span class="op">-</span> post_B<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> post_V_inv <span class="op">*</span> post_B<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  post_S      <span class="op">=</span> symmatu<span class="op">(</span>post_S<span class="op">);</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> post_nu <span class="op">=</span> prior_nu <span class="op">+</span> T<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> List<span class="op">::</span>create<span class="op">(</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    Named<span class="op">(</span><span class="st">"B"</span><span class="op">)</span>  <span class="op">=</span> post_B<span class="op">,</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    Named<span class="op">(</span><span class="st">"V"</span><span class="op">)</span>  <span class="op">=</span> post_V<span class="op">,</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    Named<span class="op">(</span><span class="st">"S"</span><span class="op">)</span>  <span class="op">=</span> post_S<span class="op">,</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    Named<span class="op">(</span><span class="st">"nu"</span><span class="op">)</span> <span class="op">=</span> post_nu</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The second function is to draw from the matrix normal distribution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>arma<span class="op">::</span>mat rmatnorm_cpp<span class="op">(</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span> M<span class="op">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span> U<span class="op">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span> V</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  mat X <span class="op">=</span> mat<span class="op">(</span>size<span class="op">(</span>M<span class="op">),</span> fill<span class="op">::</span>randn<span class="op">);</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> M <span class="op">+</span> chol<span class="op">(</span>U<span class="op">).</span>t<span class="op">()</span> <span class="op">*</span> X <span class="op">*</span> chol<span class="op">(</span>V<span class="op">);</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To draw from the inverse Wishart distribution, we use the <code>iwishrnd</code> function from the <code>RcppArmadillo</code> package. Using these three functions together, we are able to estimate the reduced-form BVAR model.</p>
<p>The following code calculates the volume element <span class="math inline">\(v_{(g\circ f_h)|\mathcal Z}\)</span> in the resampling step for the structural parameters</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> log_volume_element<span class="op">(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>field<span class="op">&lt;</span>arma<span class="op">::</span>mat<span class="op">&gt;&amp;</span> Z<span class="op">,</span> <span class="co">//Field of matrices representing narrative restrictions</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span>              A0<span class="op">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>mat<span class="op">&amp;</span>              Aplus</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  colvec vec_structural <span class="op">=</span> join_vert<span class="op">(</span>vectorise<span class="op">(</span>A0<span class="op">),</span> vectorise<span class="op">(</span>Aplus<span class="op">));</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute the derivative of the narrative restrictions wrt the structural parameters</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  mat Dz  <span class="op">=</span> Df<span class="op">([</span>Z<span class="op">](</span><span class="at">const</span> colvec<span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> zero_restrictions<span class="op">(</span>Z<span class="op">,</span> x<span class="op">);</span> <span class="op">},</span> vec_structural<span class="op">);</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute derivative of combined mapping function g_fh_vec wrt the structural parameters</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  mat Dgf <span class="op">=</span> Df<span class="op">([</span>Z<span class="op">](</span><span class="at">const</span> colvec<span class="op">&amp;</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">g_fh_vec</span><span class="op">(</span>Z<span class="op">,</span> x<span class="op">);</span> <span class="op">},</span> vec_structural<span class="op">);</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute the null space of the derivative of the narrative restrictions</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  mat DN  <span class="op">=</span> Dgf <span class="op">*</span> null<span class="op">(</span>Dz<span class="op">);</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Logarithm of determinant, then take the real part</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> log_det<span class="op">(</span>DN<span class="op">.</span>t<span class="op">()</span> <span class="op">*</span> DN<span class="op">).</span>real<span class="op">();</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="extension" class="level3">
<h3 class="anchored" data-anchor-id="extension">Extension</h3>
<p>Besides the zero and sign restrictions, another popular identification scheme proposed by <span class="citation" data-cites="antolin2018narrative">Antolı́n-Dı́az and Rubio-Ramı́rez (<a href="#ref-antolin2018narrative" role="doc-biblioref">2018</a>)</span> is to impose narrative restrictions on the structural shocks and historical decomposition. For example, restricting a structural shock to be negative during some period, and we will apply this to restrict the optimism shock during the Covid-19 pandemic.</p>
<p>But, the difficulty is that the narrative restrictions <span class="math inline">\(\mathcal{R}\)</span> requires another resample with some importance weight:</p>
<p><span class="math display">\[
\frac{1}{\omega(\mathbf{B},\mathbf{\Sigma},\mathbf{Q})} \propto \frac{\mathcal{UNIW}(\mathbf{B},\mathbf{\Sigma},\mathbf{Q}|\mathcal S, \mathcal R)}{\mathcal{UNIW}(\mathbf{B},\mathbf{\Sigma},\mathbf{Q})}
\]</span></p>
<p>To combine these two identifications, we need to calculate the importance weight when <strong>all</strong> of the three restrictions, zero, sign, and narrative, are present. Intuitively, it is the product of the importance weight for the narrative restrictions and the importance weight for the zero and sign restrictions.</p>
<!-- $$ -->
<!-- \begin{align*} -->
<!-- \frac{\mathcal{NGN}(\*A_0,\*A_+|\mathcal Z, \mathcal S, \mathcal R)}{\mathcal{UNIW}(\*B,\*\Sigma,\*Q)v_{(g\circ f_h)|\mathcal Z}(\*A_0,\*A_+)} -->
<!-- =&\frac{\mathcal{UNIW}(\*B,\*\Sigma,\*Q|\mathcal Z, \mathcal S, \mathcal R)v_{f_h}(\*A_0,\*A_+)}{\mathcal{UNIW}(\*B,\*\Sigma,\*Q)v_{(g\circ f_h)|\mathcal Z}(\*A_0,\*A_+)}\\ -->
<!-- =&\frac{\mathcal{UNIW}(\*B,\*\Sigma,\*Q|\mathcal S, \mathcal R)}{\mathcal{UNIW}(\*B,\*\Sigma,\*Q)} -->
<!-- \frac{\mathcal{UNIW}(\*B,\*\Sigma,\*Q|\mathcal Z, \mathcal S, \mathcal R)}{\mathcal{UNIW}(\*B,\*\Sigma,\*Q|\mathcal S, \mathcal R)}\\ -->
<!-- &\times -->
<!-- \frac{v_{f_h}(\*A_0,\*A_+)}{v_{(g\circ f_h)|\mathcal Z}(\*A_0,\*A_+)}\\ -->
<!-- \propto&\frac{1}{\omega(\*B,\*\Sigma,\*Q)}\frac{v_{f_h}(\*A_0,\*A_+)}{v_{(g\circ f_h)|\mathcal Z}(\*A_0,\*A_+)}\\ -->
<!-- \propto&\frac{1}{\omega(\*B,\*\Sigma,\*Q)}\frac{|\text{det}(\*A_0)|^{-(2N+K+1)}}{v_{(g\circ f_h)|\mathcal Z}(\*A_0,\*A_+)} -->
<!-- \end{align*} -->
<!-- $$ -->
<p>The following code calculates <span class="math inline">\(\omega(\mathbf{B},\mathbf{\Sigma},\mathbf{Q})\)</span> for the narrative restrictions</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> weight_narrative<span class="op">(</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span><span class="op">&amp;</span>                    T<span class="op">,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    arma<span class="op">::</span>mat                     sign_narrative<span class="op">,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> arma<span class="op">::</span>cube<span class="op">&amp;</span>             irf</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="dt">int</span> M         <span class="op">=</span> <span class="fl">1e+04</span><span class="op">;</span>  <span class="co">// number of draws to approximate normal distribution</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span>    n_success <span class="op">=</span> <span class="fl">1.0e-15</span><span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  cube      Z<span class="op">(</span>irf<span class="op">.</span>n_rows<span class="op">,</span> sign_narrative<span class="op">.</span>col<span class="op">(</span><span class="dv">5</span><span class="op">).</span>max<span class="op">()</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> M<span class="op">,</span> fill<span class="op">::</span>randn<span class="op">);</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// change all starting period to the first period</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// since we use the same M draws for all narrative restrictions</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  sign_narrative<span class="op">.</span>col<span class="op">(</span><span class="dv">4</span><span class="op">)</span> <span class="op">=</span> ones<span class="op">(</span>sign_narrative<span class="op">.</span>n_rows<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> m<span class="op">=</span><span class="dv">0</span><span class="op">;</span> m<span class="op">&lt;</span>M<span class="op">;</span> m<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>match_sign_narrative<span class="op">(</span>Z<span class="op">.</span>slice<span class="op">(</span>m<span class="op">),</span> sign_narrative<span class="op">,</span> irf<span class="op">))</span> <span class="op">{</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      n_success<span class="op">++;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> M <span class="op">/</span> n_success<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<section id="reduced-form-2" class="level3">
<h3 class="anchored" data-anchor-id="reduced-form-2">Reduced form</h3>
<p>To test the validity of our code, we simulate 1,000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2.</p>
<p>Then, we compute 1,000 posterior draws from a SVAR model with a constant term and one lag, using the default identification scheme: positive sign restrictions on the diagonal of <span class="math inline">\(\mathbf{A}_0\)</span>.</p>
<p>The posterior mean of the <span class="math inline">\(\mathbf{B}\)</span> is</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">y1</th>
<th style="text-align: right;">y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1_lag</td>
<td style="text-align: right;">0.9885</td>
<td style="text-align: right;">0.0052</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2_lag</td>
<td style="text-align: right;">0.0027</td>
<td style="text-align: right;">0.9954</td>
</tr>
<tr class="odd">
<td style="text-align: left;">constant</td>
<td style="text-align: right;">0.0589</td>
<td style="text-align: right;">0.0822</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The posterior mean of <span class="math inline">\(\mathbf{\Sigma}\)</span> is</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">y1</th>
<th style="text-align: right;">y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.9760</td>
<td style="text-align: right;">0.0881</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">0.0881</td>
<td style="text-align: right;">1.0146</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>They are close to the true values of the simulated data.</p>
</section>
<section id="structural-form-2" class="level3">
<h3 class="anchored" data-anchor-id="structural-form-2">Structural form</h3>
<p>Suppose the true structural model is</p>
<p><span class="math display">\[
\begin{bmatrix}
-1 &amp; 1\\
1 &amp; 0\\
\end{bmatrix}
\begin{bmatrix}
y_{1,t}\\
y_{2,t}\\
\end{bmatrix}
=
\begin{bmatrix}
-1 &amp; 1\\
1 &amp; 0\\
\end{bmatrix}
\begin{bmatrix}
y_{1,t-1}\\
y_{2,t-1}\\
\end{bmatrix}
+
\begin{bmatrix}
\varepsilon_{1,t}\\
\varepsilon_{2,t}\\
\end{bmatrix},
\begin{bmatrix}
\varepsilon_{1,t}\\
\varepsilon_{2,t}\\
\end{bmatrix}
\sim
\mathcal{N}(
\begin{bmatrix}
0 \\
0
\end{bmatrix}
,
\begin{bmatrix}
1 &amp; 0 \\
0 &amp; 1 \\
\end{bmatrix}
)
\]</span></p>
<p>equivalently, we can simulate 1,000 observations from the reduced-form</p>
<p><span class="math display">\[
\begin{bmatrix}
y_{1,t}\\
y_{2,t}\\
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0\\
0 &amp; 1\\
\end{bmatrix}
\begin{bmatrix}
y_{1,t-1}\\
y_{2,t-1}\\
\end{bmatrix}
+
\begin{bmatrix}
u_{1,t}\\
u_{2,t}\\
\end{bmatrix},
\begin{bmatrix}
u_{1,t}\\
u_{2,t}\\
\end{bmatrix}
\sim
\mathcal{N}(
\begin{bmatrix}
0 \\
0
\end{bmatrix}
,
\begin{bmatrix}
1 &amp; 1 \\
1 &amp; 2 \\
\end{bmatrix}
)
\]</span></p>
<p>Putting zero and sign restrictions on the inverse of the structural matrix</p>
<p><span class="math display">\[
\begin{bmatrix}
-1 &amp; 1\\
1 &amp; 0\\
\end{bmatrix}^{-1}
=
\begin{bmatrix}
0 &amp; 1\\
1 &amp; 1\\
\end{bmatrix}
\Rightarrow
\begin{bmatrix}
0 &amp; +\\
+ &amp; +\\
\end{bmatrix}
\]</span></p>
<p>Posterior mean of 1,000 draws of the structural matrix is</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]   [,2]
[1,] -0.9613 1.0448
[2,]  0.9614 0.0000</code></pre>
</div>
</div>
</section>
</section>
<section id="identification" class="level2">
<h2 class="anchored" data-anchor-id="identification">Identification</h2>
<p>The following restrictions are imposed on the contemporaneous impulse response to identify the optimism shock.</p>
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Productivity</th>
<th>Stock prices</th>
<th>Consumption</th>
<th>Real interest rate</th>
<th>Hours worked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Positive</td>
<td>Unrestricted</td>
<td>Unrestricted</td>
<td>Unrestricted</td>
</tr>
</tbody>
</table>
<p>The identification strategy is based on the assumption that the optimism shock positively affects stock prices, and has no contemporaneous effect on productivity.</p>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>Two popular methods to interpret the SVAR model are impulse response function (IRF) and forecast error variance decomposition (FEVD) <span class="citation" data-cites="kilian2017structural">(<a href="#ref-kilian2017structural" role="doc-biblioref">Kilian and Lütkepohl 2017</a>, Chap 4)</span>.</p>
<section id="irf" class="level3">
<h3 class="anchored" data-anchor-id="irf">IRF</h3>
<p>The impulse response function (IRF) of the SVAR model is used to interpret the effect of the optimism shock on the endogenous variables. Specifically, we are interested in whether a positive optimism shock leads to a simultaneous boom in consumption and hours worked (as in the United States).</p>
<p>Mathematically, the response of the <span class="math inline">\(i\)</span>-th variable to the <span class="math inline">\(j\)</span>-th shock at horizon <span class="math inline">\(k\)</span> is given by the element at row <span class="math inline">\(i\)</span> columns <span class="math inline">\(j\)</span> of <span class="math inline">\(\mathbf{\Theta}_k\)</span>, where <span class="math inline">\(\mathbf{\Theta}_k\)</span> is defined recursively as</p>
<span class="math display">\[\begin{aligned}&amp;\mathbf{\Theta}_{0} = \left(\mathbf{A}_{0}^{-1}\right)^{\prime},\quad\mathbf{\Theta}_{h} = \sum_{l=1}^{h}\bigl(\mathbf{A}_{\ell}\mathbf{A}_{0}^{-1}\bigr)^{\prime}\mathbf{\Theta}_{h-\ell},\quad\mathrm{} 1 \leq h \leq p,\\&amp;\mathbf{\Theta}_{h} = \sum_{\ell=1}^{p}\bigl(\mathbf{A}_{\ell}\mathbf{A}_{0}^{-1}\bigr)^{\prime}\mathbf{\Theta}_{h-\ell},\quad\mathrm{} p &lt; h &lt; \infty.\end{aligned}\]</span>
</section>
<section id="fevd" class="level3">
<h3 class="anchored" data-anchor-id="fevd">FEVD</h3>
<p>The forecast error variance decomposition (FEVD) is used to quantify the relative importance of the optimism shock in explaining the variability of a <span class="math inline">\(h\)</span>-step ahead forecast of a particular variable. For example, we will examine the proportion of the variability of consumption and hours worked explained by the optimism shock.</p>
<p>Mathematically, the <span class="math inline">\(i\)</span>-th variable’s forecast error variance decomposition of the <span class="math inline">\(j\)</span>-th shock at horizon <span class="math inline">\(h\)</span> is given by</p>
<p><span class="math display">\[
\text{FEVD}_j^i(h) = \frac{\text{MSFE}_{j}^{i}(h)}{\sum_{n=1}^{N}\text{MSFE}_{j}^{n}(h)}, \quad \text{MSFE}_{j}^{i}(h) = \sum_{l=0}^{h-1} \mathbf{\Theta}_{ij,l}^{2}
\]</span></p>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="us-data" class="level2">
<h2 class="anchored" data-anchor-id="us-data">US data</h2>
<p>First, we apply the package to the data from the United States, and replicate the results in <span class="citation" data-cites="arias2018inference">Arias, Rubio-Ramı́rez, and Waggoner (<a href="#ref-arias2018inference" role="doc-biblioref">2018</a>)</span>.</p>
<section id="irf-1" class="level3">
<h3 class="anchored" data-anchor-id="irf-1">IRF</h3>
<p>The impulse response functions are</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/us-irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">US IRF</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>where shock 1 is the optimism shock, and it gives very close impulse response functions to the ones in the original paper.</p>
</section>
<section id="fevd-1" class="level3">
<h3 class="anchored" data-anchor-id="fevd-1">FEVD</h3>
<p>The forecast error variance decomposition of consumption and hours worked are</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/us-fevd-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">US FEVD</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>(where shock 1 is the optimism shock, same for all subsequent plots)</p>
<p>Share of FEVD attributed to the optimism shock at horizon 40 (10 years) are</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">16%</th>
<th style="text-align: right;">50%</th>
<th style="text-align: right;">84%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">productivity</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">7.69</td>
<td style="text-align: right;">20.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">stock_prices</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">18.58</td>
<td style="text-align: right;">42.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumption</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">18.76</td>
<td style="text-align: right;">43.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">real_interest_rate</td>
<td style="text-align: right;">5.70</td>
<td style="text-align: right;">19.69</td>
<td style="text-align: right;">43.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hours_worked</td>
<td style="text-align: right;">4.34</td>
<td style="text-align: right;">14.42</td>
<td style="text-align: right;">33.82</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>(the columns represent the median and 68% credible interval)</p>
</section>
</section>
<section id="australian-data" class="level2">
<h2 class="anchored" data-anchor-id="australian-data">Australian data</h2>
<p>All subsequent analysis are performed on the Australian data.</p>
<section id="history" class="level3">
<h3 class="anchored" data-anchor-id="history">History</h3>
<p>Historical values of the optimism shock is</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/au-shock-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="irf-2" class="level3">
<h3 class="anchored" data-anchor-id="irf-2">IRF</h3>
<p>The impulse response functions are</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/au-irf-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comparing with the US data, the optimism shock has a much smaller effect on consumption and hours worked in Australia, only stock prices has a significant effect in the short run.</p>
</section>
<section id="fevd-2" class="level3">
<h3 class="anchored" data-anchor-id="fevd-2">FEVD</h3>
<p>The forecast error variance decomposition of consumption and hours worked are</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/au-fevd-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Australian FEVD</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Share of FEVD attributed to the optimism shock at horizon 40 (10 years) are</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">16%</th>
<th style="text-align: right;">50%</th>
<th style="text-align: right;">84%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">productivity</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">7.07</td>
<td style="text-align: right;">24.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">stock_prices</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">14.16</td>
<td style="text-align: right;">41.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumption</td>
<td style="text-align: right;">3.41</td>
<td style="text-align: right;">14.19</td>
<td style="text-align: right;">41.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">real_interest_rate</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">42.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hours_worked</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">18.65</td>
<td style="text-align: right;">48.86</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="extension-1" class="level2">
<h2 class="anchored" data-anchor-id="extension-1">Extension</h2>
<p>Now we introduce an additional narrative restrictions that</p>
<blockquote class="blockquote">
<p>the optimism shock is <strong>negative</strong> when Covid-19 hits Australia in 2020 Q1.</p>
</blockquote>
<section id="history-1" class="level3">
<h3 class="anchored" data-anchor-id="history-1">History</h3>
<p>Historical values of the optimism shock is</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/au-ext-shock-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="irf-3" class="level3">
<h3 class="anchored" data-anchor-id="irf-3">IRF</h3>
<p>The impulse response functions are</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/au-ext-irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Australian IRF with narrative restriction</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Still no significant effects.</p>
</section>
<section id="fevd-3" class="level3">
<h3 class="anchored" data-anchor-id="fevd-3">FEVD</h3>
<p>The forecast error variance decomposition of consumption and hours worked are</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/au-ext-fevd-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Australian FEVD with narrative restriction</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Share of FEVD attributed to the optimism shock at horizon 40 (10 years) are</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">16%</th>
<th style="text-align: right;">50%</th>
<th style="text-align: right;">84%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">productivity</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">6.81</td>
<td style="text-align: right;">24.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">stock_prices</td>
<td style="text-align: right;">3.36</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">43.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumption</td>
<td style="text-align: right;">3.49</td>
<td style="text-align: right;">15.49</td>
<td style="text-align: right;">41.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">real_interest_rate</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">13.40</td>
<td style="text-align: right;">41.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hours_worked</td>
<td style="text-align: right;">3.68</td>
<td style="text-align: right;">17.48</td>
<td style="text-align: right;">47.60</td>
</tr>
</tbody>
</table>
</div>
</div>



</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-antolin2018narrative" class="csl-entry" role="listitem">
Antolı́n-Dı́az, Juan, and Juan F Rubio-Ramı́rez. 2018. <span>“Narrative Sign Restrictions for SVARs.”</span> <em>American Economic Review</em> 108 (10): 2802–29.
</div>
<div id="ref-arias2018inference" class="csl-entry" role="listitem">
Arias, Jonas E, Juan F Rubio-Ramı́rez, and Daniel F Waggoner. 2018. <span>“Inference Based on Structural Vector Autoregressions Identified with Sign and Zero Restrictions: Theory and Applications.”</span> <em>Econometrica</em> 86 (2): 685–720.
</div>
<div id="ref-beaudry2011mood" class="csl-entry" role="listitem">
Beaudry, Paul, Deokwoo Nam, and Jian Wang. 2011. <span>“Do Mood Swings Drive Business Cycles and Is It Rational?”</span> National Bureau of Economic Research.
</div>
<div id="ref-kilian2017structural" class="csl-entry" role="listitem">
Kilian, Lutz, and Helmut Lütkepohl. 2017. <em>Structural Vector Autoregressive Analysis</em>. Cambridge University Press.
</div>
<div id="ref-rubio2010structural" class="csl-entry" role="listitem">
Rubio-Ramirez, Juan F, Daniel F Waggoner, and Tao Zha. 2010. <span>“Structural Vector Autoregressions: Theory of Identification and Algorithms for Inference.”</span> <em>The Review of Economic Studies</em> 77 (2): 665–96.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Intuitively, the PFA uses a loss function to find a rotation matrix <span class="math inline">\(\mathbf{Q}\)</span> that satisfies the zero restrictions and satisfies or close to satisfying the sign restrictions, thus it is not an exact solution. In comparison, the importance sampler algorithm is an exact solution satisfying all the restrictions.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>