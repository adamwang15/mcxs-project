[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "",
    "text": "Abstract. This article investigates the effects of optimism shocks on the Australian economy using a Bayesian Structural Vector Autoregression (BSVAR) model. We implement the sign and zero restrictions algorithm proposed by Arias, Rubio-Ramı́rez, and Waggoner (2018) to identify the optimism shock. Impulse response functions (IRF) and forecast error variance decomposition (FEVD) are used to analyse the effects of the optimism shock on five key macroeconomic variables: productivity, stock prices, consumption, real interest rate and hours worked.\nKeywords. Bayesian Structural VAR, sign restrictions, zero restrictions, optimism shock"
  },
  {
    "objectID": "index.html#acf-and-pacf-plot",
    "href": "index.html#acf-and-pacf-plot",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "ACF and PACF plot",
    "text": "ACF and PACF plot\n\n\n\n\n\nFigure 1: ACF Plots\n\n\n\n\nThe autocorrelation function (ACF) plot shows all variables have a consistent pattern of autocorrelation, this suggests that the time series are non-stationary. Stationarity is formally tested using the Augmented Dickey-Fuller test in the next section.\n\n\n\n\n\nFigure 2: PACF Plots\n\n\n\n\nThe partial autocorrelation function (PACF) plot shows that the partial autocorrelation of all variables is significant at lag 1, real interest rate is also significant at lag 2. Therefore, choosing a lag length for the VAR model greater than or equal to 2 is reasonable, following convention for quarterly data, we will adopt a lag length of 4 for the VAR model."
  },
  {
    "objectID": "index.html#augmented-dickey-fuller-test",
    "href": "index.html#augmented-dickey-fuller-test",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Augmented Dickey-Fuller test",
    "text": "Augmented Dickey-Fuller test\n\nLevel\nAll five variables are non-stationary at 5% significance level base on the Augmented Dickey-Fuller test.\n\n\n\n\n\nvariable\np_value\nnon_stationary\n\n\n\n\nproductivity\n0.8093\n1\n\n\nstock_prices\n0.1600\n1\n\n\nconsumption\n0.6469\n1\n\n\nreal_interest_rate\n0.3812\n1\n\n\nhours_worked\n0.0520\n1\n\n\n\n\n\n\n\nFirst difference\nApplying Augmented Dickey-Fuller test to the first difference of the variables, we find that all variables are stationary at 5% significance level. Therefore, all variables are integrated of order one \\(I(1)\\) and it is reasonable to put them in a VAR system without further transformation.\n\n\n\n\n\nvariable\np_value\nnon_stationary\n\n\n\n\nproductivity\n0.01\n0\n\n\nstock_prices\n0.01\n0\n\n\nconsumption\n0.01\n0\n\n\nreal_interest_rate\n0.01\n0\n\n\nhours_worked\n0.01\n0"
  },
  {
    "objectID": "index.html#specification",
    "href": "index.html#specification",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Specification",
    "text": "Specification\nAdopting notations from Rubio-Ramirez, Waggoner, and Zha (2010), the SVAR model is specified as follows.\nThe endogenous variables are\n\\[\n\\mathbf{y}_t = [\\text{productivity}_t,\\ \\text{stock prices}_t,\\ \\text{consumption}_t,\\ \\text{real interest rate}_t,\\ \\text{hours worked}_t]'\n\\]\n\nStructural form\n\\[\n\\begin{align*}\n\\mathbf{y}_t' \\mathbf{A}_0 &= \\sum_{l=1}^{p} \\mathbf{y}_{t-l}'\\mathbf{A}_l + \\mathbf{c} + \\boldsymbol{\\varepsilon}_t' \\\\\n\\boldsymbol{\\varepsilon}_t | \\mathbf{Y}_{t-1} &\\overset{\\text{iid}}{\\sim} \\mathcal{N}_N(\\mathbf{0}, \\mathbf{I})\n\\end{align*}\n\\]\nwhere \\(\\mathbf{y}_t\\) is an \\(N\\times1\\) vector of endogenous variables, \\(\\boldsymbol{\\varepsilon}_t\\) is an \\(N\\times1\\) vector of exogenous structural shocks, \\(\\mathbf{A}_l\\) is an \\(N\\times N\\) matrix of parameters with \\(\\mathbf{A}_0\\) invertible, \\(\\mathbf{c}\\) is an \\(1\\times N\\) vector of parameters, and \\(p\\) is the lag length, and \\(T\\) is the sample size. This can be compactly written as\n\\[\n\\begin{align*}\n\\mathbf{y}_t' \\mathbf{A}_0 &= \\mathbf{x}_t' \\mathbf{A}_+ + \\boldsymbol{\\varepsilon}_t'\n\\end{align*}\n\\]\nwhere \\(\\mathbf{A}_+ = [\\mathbf{A}_1'\\ \\cdots\\ \\mathbf{A}_p'\\ \\hspace{4mm}\\mathbf{c}']\\) and \\(\\mathbf{x}_t = [\\mathbf{y}_{t-1}'\\ \\cdots\\ \\mathbf{y}_{t-p}'\\hspace{4mm}\\ 1]\\). The dimension of \\(\\mathbf{A}_+\\) is \\(K\\times N\\) where \\(K=Np+1\\).\nIn matrix form,\n\\[\n\\begin{align*}\n\\mathbf{Y} \\mathbf{A}_0 &= \\mathbf{X} \\mathbf{A}_+ + \\boldsymbol{\\varepsilon}\\\\\n\\boldsymbol{\\varepsilon}| \\mathbf{X} &\\sim \\mathcal{MN}_{T\\times N}(\\mathbf{0}, \\mathbf{I}_N, \\mathbf{I}_T)\n\\end{align*}\n\\]\nwhere \\(\\mathbf{Y} = [\\mathbf{y}_1\\ \\cdots\\ \\mathbf{y}_T]'\\), \\(\\mathbf{X} = [\\mathbf{x}_1\\ \\cdots\\ \\mathbf{x}_T]'\\), and \\(\\boldsymbol{\\varepsilon}= [\\boldsymbol{\\varepsilon}_1\\ \\cdots\\ \\boldsymbol{\\varepsilon}_T]'\\).\nThe matrices \\(\\mathbf{A}_0\\) and \\(\\mathbf{A}_+\\) are structural parameters.\n\n\nReduced form\n\\[\n\\begin{align*}\n\\mathbf{y}_t' &= \\mathbf{x}_t' \\mathbf{B} + \\mathbf{u}_t' \\\\\n\\mathbf{u}_t | \\mathbf{Y}_{t-1} &\\overset{\\text{iid}}{\\sim} \\mathcal{N}_N(\\mathbf{0}, \\mathbf{\\Sigma})\n\\end{align*}\n\\]\nwhere \\(\\mathbf{B} = \\mathbf{A}_ + \\mathbf{A}_0^{-1},\\ \\mathbf{u}_t' = \\boldsymbol{\\varepsilon}_t' \\mathbf{A}_0^{-1}\\), and\n\\[\n\\mathbf{\\Sigma }= \\mathbb{E}[\\mathbf{u}_t\\mathbf{u}_t'] = (\\mathbf{A}_0^{-1})' (\\mathbf{A}_0^{-1}) = (\\mathbf{A}_0 \\mathbf{A}_0')^{-1}\n\\]\nIn matrix form,\n\\[\n\\begin{align*}\n\\mathbf{Y} &= \\mathbf{X} \\mathbf{B} + \\mathbf{u} \\\\\n\\mathbf{u} | \\mathbf{X} &\\sim \\mathcal{MN}_{T\\times n}(\\mathbf{0}, \\mathbf{\\Sigma}, \\mathbf{I}_T)\n\\end{align*}\n\\]\nwhere \\(\\mathbf{u} = [\\mathbf{u}_1\\ \\cdots\\ \\mathbf{u}_T]'\\).\nThe matrices \\(\\mathbf{B}\\) and \\(\\mathbf{\\Sigma}\\) are reduced-form parameters.\n\n\nOrthogonal reduced-form parameterization\nSince SVAR model are identified up to a rotation matrix \\(\\mathbf{Q}\\), we can explicitly specified the reduced-form model as\n\\[\n\\mathbf{y}_t' = \\mathbf{x}_t' \\mathbf{B} + \\boldsymbol{\\varepsilon}_t' \\mathbf{Q}' h(\\mathbf{\\Sigma})\n\\]\nWhere \\(\\mathbf{Q}'h(\\mathbf{\\Sigma}) = \\mathbf{A}_0^{-1}\\) or \\(\\mathbf{Q}=h(\\mathbf{\\Sigma}) \\mathbf{A}_0\\), and \\(h\\) is some differentiable decomposition, one specific choice is the upper triangular Cholesky decomposition.\nThen, we can define a mapping \\(f_h\\) between the reduced-form parameters \\((\\mathbf{B}, \\mathbf{\\Sigma}, \\mathbf{Q})\\) and structural-form parameters \\((\\mathbf{A}_0, \\mathbf{A}_+)\\) as\n\\[\n\\begin{align*}\nf_h(\\mathbf{A}_0, \\mathbf{A}_+) &= (\n  \\underbrace{\\mathbf{A}_+ \\mathbf{A}_0^{-1}}_\\mathbf{B},\n  \\underbrace{(\\mathbf{A}_0 \\mathbf{A}_0')^{-1}}_{\\mathbf{\\Sigma}},\n  \\underbrace{h((\\mathbf{A}_0 \\mathbf{A}_0')^{-1}) \\mathbf{A}_0}_\\mathbf{Q}\n  ) \\\\\nf_h^{-1}(\\mathbf{B}, \\mathbf{\\Sigma}, \\mathbf{Q}) &= (\n  \\underbrace{h(\\mathbf{\\Sigma})^{-1} \\mathbf{Q}}_{\\mathbf{A}_0},\n  \\underbrace{\\mathbf{B} h(\\mathbf{\\Sigma})^{-1} \\mathbf{Q}}_{\\mathbf{A}_+}\n  )\n\\end{align*}\n\\]"
  },
  {
    "objectID": "index.html#bayesian-inference",
    "href": "index.html#bayesian-inference",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Bayesian inference",
    "text": "Bayesian inference\n\nDerivations\nThe first step is to sample the reduced-form parameters (\\(\\mathbf{B}\\), \\(\\mathbf{\\Sigma}\\)). Adopting the conjugate Normal-Inverse-Wishart prior,\n\\[\n\\begin{align*}\n\\mathbf{B}|\\mathbf{\\Sigma }&\\sim \\mathcal{MN}_{K\\times N}(\\underline{\\mathbf{B}}, \\underline{\\mathbf{V}},\\mathbf{\\Sigma}) \\\\\n\\mathbf{\\Sigma }&\\sim \\mathcal{IW}_N(\\underline{\\mathbf{S}}, \\underline{\\nu})\n\\end{align*}\n\\]\nand let\n\\[\n\\begin{align*}\n\\hat{\\mathbf{B}} &= (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{Y} \\\\\n\\mathbf{R} &= (\\mathbf{Y}-\\mathbf{X}\\hat{\\mathbf{B}})'(\\mathbf{Y}-\\mathbf{X}\\hat{\\mathbf{B}})\n\\end{align*}\n\\]\nthe conjugate posterior distribution can be derived from\n\\[\\begin{align*}\np(\\mathbf{B},\\mathbf{\\Sigma}|\\mathbf{Y})\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ \\mathbf{\\Sigma}^{-1}(\\mathbf{Y}-\\mathbf{X}\\mathbf{B})'(\\mathbf{Y}-\\mathbf{X}\\mathbf{B}) \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}[\\mathbf{\\Sigma}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+N+1)/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}(\\underline{\\mathbf{S}}\\mathbf{\\Sigma}^{-1}) \\right\\} \\\\\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ \\left( \\mathbf{R}+(\\mathbf{B}-\\hat{\\mathbf{B}})'\\mathbf{X}'\\mathbf{X}(\\mathbf{B}-\\hat{\\mathbf{B}}) \\right) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}[(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1}] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+N+1)/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}(\\underline{\\mathbf{S}}\\mathbf{\\Sigma}^{-1}) \\right\\} \\\\\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ \\left( (\\mathbf{B}-\\hat{\\mathbf{B}})'\\mathbf{X}'\\mathbf{X}(\\mathbf{B}-\\hat{\\mathbf{B}})+(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}}) \\right) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{R}+\\underline{\\mathbf{S}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=|\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ (\\mathbf{B}-\\overline{\\mathbf{B}})'\\overline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\overline{\\mathbf{B}}) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{R}+\\underline{\\mathbf{S}}+\\hat{\\mathbf{B}}'\\mathbf{X}'\\mathbf{X}\\hat{\\mathbf{B}}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}^{-1}\\overline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=|\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ (\\mathbf{B}-\\overline{\\mathbf{B}})'\\overline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\overline{\\mathbf{B}}) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{Y}'\\mathbf{Y}+\\underline{\\mathbf{S}}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}\\overline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=p(\\mathbf{B}|\\mathbf{\\Sigma},\\mathbf{Y})\\times p(\\mathbf{\\Sigma}|\\mathbf{Y})\n\\end{align*}\\]\nTherefore, the posterior distribution of the reduced-form parameters is given by\n\\[\n\\begin{align*}\n\\mathbf{B}|\\mathbf{\\Sigma},\\mathbf{Y} &\\sim \\mathcal{MN}_{K\\times N}(\\overline{\\mathbf{B}}, \\overline{\\mathbf{V}},\\mathbf{\\Sigma}) \\\\\n\\mathbf{\\Sigma}|\\mathbf{Y} &\\sim \\mathcal{IW}_N(\\overline{\\mathbf{S}}, \\overline{\\nu})\n\\end{align*}\n\\]\nwhere\n\\[\n\\begin{align*}\n\\overline{\\mathbf{B}} &= \\overline{\\mathbf{V}}(\\mathbf{X}'\\mathbf{Y}+\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}) \\\\\n\\overline{\\mathbf{V}} &= (\\mathbf{X}'\\mathbf{X}+\\underline{\\mathbf{V}}^{-1})^{-1} \\\\\n\\overline{\\mathbf{S}} &= \\underline{\\mathbf{S}}+\\mathbf{Y}'\\mathbf{Y}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}^{-1}\\overline{\\mathbf{B}} \\\\\n\\overline{\\nu} &= \\underline{\\nu}+T\n\\end{align*}\n\\]\n\n\nImplementation\nFor computational efficiency, main functions in the bsvarSIGNs package are written in C++. The first function is compute posterior parameters as derived above.\nRcpp::List niw_cpp(\n    const arma::mat& Y,\n    const arma::mat& X,\n    const Rcpp::List prior\n) {\n\n  const int T  = Y.n_rows;\n  \n  mat prior_B  = as&lt;mat&gt;(prior[\"B\"]);\n  mat prior_V  = as&lt;mat&gt;(prior[\"V\"]);\n  mat prior_S  = as&lt;mat&gt;(prior[\"S\"]);\n  int prior_nu = as&lt;int&gt;(prior[\"nu\"]);\n  \n  // analytic solutions\n  mat prior_V_inv = inv_sympd(prior_V);\n  mat post_V_inv  = prior_V_inv + X.t() * X;\n  mat post_V      = inv_sympd(post_V_inv);\n  mat post_B      = post_V * (X.t() * Y + prior_V_inv * prior_B);\n  \n  // marginal posterior of Sigma\n  mat post_S  = prior_S + Y.t() * Y + prior_B.t() * prior_V_inv * prior_B - post_B.t() * post_V_inv * post_B;\n  post_S      = symmatu(post_S);\n  int post_nu = prior_nu + T;\n  \n  return List::create(\n    Named(\"B\")  = post_B,\n    Named(\"V\")  = post_V,\n    Named(\"S\")  = post_S,\n    Named(\"nu\") = post_nu\n  );\n}\nThe second function is to draw from the matrix normal distribution.\narma::mat rmatnorm_cpp(\n    const arma::mat& M,\n    const arma::mat& U,\n    const arma::mat& V\n) {\n  \n  mat X = mat(size(M), fill::randn);\n  return M + chol(U).t() * X * chol(V);\n}\nTo draw from the inverse Wishart distribution, we use the iwishrnd function from the RcppArmadillo package.\nUsing these three functions together, we are able to estimate the reduced-form BVAR model."
  },
  {
    "objectID": "index.html#identification",
    "href": "index.html#identification",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Identification",
    "text": "Identification\nThe following restrictions are imposed on the contemporaneous impulse response to identify the optimism shock.\n\n\n\n\n\n\n\n\n\n\nProductivity\nStock prices\nConsumption\nReal interest rate\nHours worked\n\n\n\n\n0\nPositive\nUnrestricted\nUnrestricted\nUnrestricted\n\n\n\nThe identification strategy is based on the assumption that the optimism shock positively affects stock prices, and has no contemporaneous effect on productivity."
  },
  {
    "objectID": "index.html#algorithm",
    "href": "index.html#algorithm",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Algorithm",
    "text": "Algorithm\n\nReduced form\nThe first step is to sample the reduced-form parameters (\\(\\mathbf{B}\\), \\(\\mathbf{\\Sigma}\\)). Adopting the conjugate Normal-Inverse-Wishart prior,\n\\[\n\\begin{align*}\n\\mathbf{B}|\\mathbf{\\Sigma }&\\sim \\mathcal{MN}_{K\\times N}(\\underline{\\mathbf{B}}, \\underline{\\mathbf{V}},\\mathbf{\\Sigma}) \\\\\n\\mathbf{\\Sigma }&\\sim \\mathcal{IW}_N(\\underline{\\mathbf{S}}, \\underline{\\nu})\n\\end{align*}\n\\]\nand let\n\\[\n\\begin{align*}\n\\hat{\\mathbf{B}} &= (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{Y} \\\\\n\\mathbf{R} &= (\\mathbf{Y}-\\mathbf{X}\\hat{\\mathbf{B}})'(\\mathbf{Y}-\\mathbf{X}\\hat{\\mathbf{B}})\n\\end{align*}\n\\]\nthe conjugate posterior distribution can be derived from\n\\[\\begin{align*}\np(\\mathbf{B},\\mathbf{\\Sigma}|\\mathbf{Y})\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ \\mathbf{\\Sigma}^{-1}(\\mathbf{Y}-\\mathbf{X}\\mathbf{B})'(\\mathbf{Y}-\\mathbf{X}\\mathbf{B}) \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}[\\mathbf{\\Sigma}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+N+1)/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}(\\underline{\\mathbf{S}}\\mathbf{\\Sigma}^{-1}) \\right\\} \\\\\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ \\left( \\mathbf{R}+(\\mathbf{B}-\\hat{\\mathbf{B}})'\\mathbf{X}'\\mathbf{X}(\\mathbf{B}-\\hat{\\mathbf{B}}) \\right) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}[(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1}] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+N+1)/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}(\\underline{\\mathbf{S}}\\mathbf{\\Sigma}^{-1}) \\right\\} \\\\\n\n&\\propto |\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ \\left( (\\mathbf{B}-\\hat{\\mathbf{B}})'\\mathbf{X}'\\mathbf{X}(\\mathbf{B}-\\hat{\\mathbf{B}})+(\\mathbf{B}-\\underline{\\mathbf{B}})'\\underline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\underline{\\mathbf{B}}) \\right) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{R}+\\underline{\\mathbf{S}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=|\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ (\\mathbf{B}-\\overline{\\mathbf{B}})'\\overline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\overline{\\mathbf{B}}) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{R}+\\underline{\\mathbf{S}}+\\hat{\\mathbf{B}}'\\mathbf{X}'\\mathbf{X}\\hat{\\mathbf{B}}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}^{-1}\\overline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=|\\mathbf{\\Sigma}|^{-T/2}\\exp\\left\\{ -\\frac{1}{2} \\text{tr}\\left[ (\\mathbf{B}-\\overline{\\mathbf{B}})'\\overline{\\mathbf{V}}^{-1}(\\mathbf{B}-\\overline{\\mathbf{B}}) \\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n&\\quad\\times |\\mathbf{\\Sigma}|^{-(\\underline\\nu+T+N+1)/2}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ (\\mathbf{Y}'\\mathbf{Y}+\\underline{\\mathbf{S}}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}\\overline{\\mathbf{B}})\\mathbf{\\Sigma}^{-1} \\right] \\right\\} \\\\\n\n&=p(\\mathbf{B}|\\mathbf{\\Sigma},\\mathbf{Y})\\times p(\\mathbf{\\Sigma}|\\mathbf{Y})\n\\end{align*}\\]\nTherefore, the posterior distribution of the reduced-form parameters is given by\n\\[\n\\begin{align*}\n\\mathbf{B}|\\mathbf{\\Sigma},\\mathbf{Y} &\\sim \\mathcal{MN}_{K\\times N}(\\overline{\\mathbf{B}}, \\overline{\\mathbf{V}},\\mathbf{\\Sigma}) \\\\\n\\mathbf{\\Sigma}|\\mathbf{Y} &\\sim \\mathcal{IW}_N(\\overline{\\mathbf{S}}, \\overline{\\nu})\n\\end{align*}\n\\]\nwhere\n\\[\n\\begin{align*}\n\\overline{\\mathbf{B}} &= \\overline{\\mathbf{V}}(\\mathbf{X}'\\mathbf{Y}+\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}) \\\\\n\\overline{\\mathbf{V}} &= (\\mathbf{X}'\\mathbf{X}+\\underline{\\mathbf{V}}^{-1})^{-1} \\\\\n\\overline{\\mathbf{S}} &= \\underline{\\mathbf{S}}+\\mathbf{Y}'\\mathbf{Y}+\\underline{\\mathbf{B}}'\\underline{\\mathbf{V}}^{-1}\\underline{\\mathbf{B}}-\\overline{\\mathbf{B}}'\\overline{\\mathbf{V}}^{-1}\\overline{\\mathbf{B}} \\\\\n\\overline{\\nu} &= \\underline{\\nu}+T\n\\end{align*}\n\\]\n\n\nStructural form\nTo perform zero and sign restrictions, we need an algorithm to sample from the posterior distribution of the structural parameters (\\(\\mathbf{A}_0\\), \\(\\mathbf{A}_+\\)) conditional on the zero and sign restrictions.\nHowever, the set of structural parameters satisfying the zero restrictions is of Lebesgue measure zero in the set of all structural parameters (akin to \\(\\mathbb{P}(X=x)=0\\) for continuous \\(X\\)). Luckily, we can sample the set of structural parameters satisfying the sign restrictions conditional on satisfying the zero restrictions.\nHere is a high level outline of the algorithm proposed by Arias, Rubio-Ramı́rez, and Waggoner (2018):\n\nSample reduced-form parameters \\(\\mathbf{B},\\mathbf{\\Sigma}\\sim \\mathcal{NIW}(\\overline{\\mathbf{B}},\\overline{\\mathbf{V}},\\overline{\\mathbf{S}},\\overline{\\mathbf{\\nu}})\\).\nSample \\(\\mathbf{Q}\\) conditional on the zero restrictions and set \\((\\mathbf{A}_0, \\mathbf{A}_+) = f_h^{-1}(\\mathbf{B}, \\mathbf{\\Sigma}, \\mathbf{Q})\\).\nIf the sign restrictions are satisfied, keep \\((\\mathbf{A}_0, \\mathbf{A}_+)\\) and compute an importance weight, otherwise discard.\nRepeat steps 1-3 until the desired number of samples is obtained.\nResample with replacement using the importance weights.\n\nWhere step 5 (importance sampling) is needed to manipulate the density induced by step 1 to the desired Nomral-Generalized-Normal posterior density \\(\\mathcal{NGN}\\).\nTo be explicit, starting with a Uniform-Normal-Inverse-Wishart prior distribution, the importance weight in step 3 is given by (posterior condition on \\(\\mathbf{Y}\\) is dropped for brevity):\n\\[\n\\begin{align*}\n\\frac{\\mathcal{NGN}(\\mathbf{A}_0,\\mathbf{A}_+|\\mathcal Z, \\mathcal S)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\n&=\\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal Z, \\mathcal S)v_{f_h}(\\mathbf{A}_0,\\mathbf{A}_+)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\\\\\n&\\propto\\frac{|\\text{det}(\\mathbf{A}_0)|^{-(2N+K+1)}}{v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\n\\end{align*}\n\\]\nwhere \\(\\mathcal Z\\) denotes zero restrictions and \\(\\mathcal S\\) denotes sign restrictions. The numerator is the target density, and the denominator is the proposal density from steps 1-2.\n\n\nImplementations\nFor computational efficiency, main functions in the bsvarSIGNs package are written in C++. The first function is compute posterior parameters as derived above.\nRcpp::List niw_cpp(\n    const arma::mat& Y,\n    const arma::mat& X,\n    const Rcpp::List prior\n) {\n\n  const int T  = Y.n_rows;\n  \n  mat prior_B  = as&lt;mat&gt;(prior[\"B\"]);\n  mat prior_V  = as&lt;mat&gt;(prior[\"V\"]);\n  mat prior_S  = as&lt;mat&gt;(prior[\"S\"]);\n  int prior_nu = as&lt;int&gt;(prior[\"nu\"]);\n  \n  // analytic solutions\n  mat prior_V_inv = inv_sympd(prior_V);\n  mat post_V_inv  = prior_V_inv + X.t() * X;\n  mat post_V      = inv_sympd(post_V_inv);\n  mat post_B      = post_V * (X.t() * Y + prior_V_inv * prior_B);\n  \n  // marginal posterior of Sigma\n  mat post_S  = prior_S + Y.t() * Y + prior_B.t() * prior_V_inv * prior_B - post_B.t() * post_V_inv * post_B;\n  post_S      = symmatu(post_S);\n  int post_nu = prior_nu + T;\n  \n  return List::create(\n    Named(\"B\")  = post_B,\n    Named(\"V\")  = post_V,\n    Named(\"S\")  = post_S,\n    Named(\"nu\") = post_nu\n  );\n}\nThe second function is to draw from the matrix normal distribution.\narma::mat rmatnorm_cpp(\n    const arma::mat& M,\n    const arma::mat& U,\n    const arma::mat& V\n) {\n  \n  mat X = mat(size(M), fill::randn);\n  return M + chol(U).t() * X * chol(V);\n}\nTo draw from the inverse Wishart distribution, we use the iwishrnd function from the RcppArmadillo package. Using these three functions together, we are able to estimate the reduced-form BVAR model.\nThe following code calculates the volume element \\(v_{(g\\circ f_h)|\\mathcal Z}\\) in the resampling step for the structural parameters\ndouble log_volume_element(\n    const arma::field&lt;arma::mat&gt;& Z, //Field of matrices representing narrative restrictions\n    const arma::mat&              A0,\n    const arma::mat&              Aplus\n) {\n  colvec vec_structural = join_vert(vectorise(A0), vectorise(Aplus));\n  \n  // Compute the derivative of the narrative restrictions wrt the structural parameters\n  mat Dz  = Df([Z](const colvec& x) { return zero_restrictions(Z, x); }, vec_structural);\n  \n  // Compute derivative of combined mapping function g_fh_vec wrt the structural parameters\n  mat Dgf = Df([Z](const colvec& x) { return g_fh_vec(Z, x); }, vec_structural);\n  \n  // Compute the null space of the derivative of the narrative restrictions\n  mat DN  = Dgf * null(Dz);\n  \n  // Logarithm of determinant, then take the real part\n  return 0.5 * log_det(DN.t() * DN).real();\n}\n\n\nComparison with PFA\nThe PFA uses a loss function to find a rotation matrix \\(\\mathbf{Q}\\) that satisfies the zero restrictions and satisfies or close to satisfying the sign restrictions, thus it is not an exact solution. In comparison, the importance sampler algorithm is an exact solution satisfying all the restrictions.\nMathematically, the PFA solves the following minimization problem:\n\\[\n\\begin{aligned}\nq^* &= {\\arg\\min}_q \\Psi(q) \\quad s.t. (1)\\ q'q=1,\\ (2)\\ R_{zero}q=0\n\\end{aligned}\n\\]\nwhere \\(q\\) is a column of \\(\\mathbf{Q}\\). This step is analogous to steps 2-3 of the importance sampler algorithm. Intuitively, by minimizing \\(\\Psi(q)\\) we can find something close to satisfying the sign restrictions, condition (1) makes sure \\(\\mathbf{Q}\\) is orthogonal and condition (2) makes sure \\(\\mathbf{Q}\\) satisfies the zero restrictions.\nDetailed definitions of \\(\\Psi\\) and \\(R_{zero}\\) is beyond the scope of this project, but it is evident that the minimization problem gives an unique solution and therefore the PFA is not set-identifying \\(\\mathbf{Q}\\).\n\n\nExtension\nBesides the zero and sign restrictions, another popular identification scheme proposed by Antolı́n-Dı́az and Rubio-Ramı́rez (2018) is to impose narrative restrictions on the structural shocks and historical decomposition. For example, restricting a structural shock to be negative during some period, and we will apply this to restrict the optimism shock during the Covid-19 pandemic.\nBut, the difficulty is that the narrative restrictions \\(\\mathcal{R}\\) requires another resample with some importance weight:\n\\[\n\\frac{1}{\\omega(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})} \\propto \\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal S, \\mathcal R)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})}\n\\]\nTo combine these two identifications, we need to calculate the importance weight when all of the three restrictions, zero, sign, and narrative, are present. Intuitively, it is the product of the importance weight for the narrative restrictions and the importance weight for the zero and sign restrictions.\nHere is an preliminary proof. The insight is to notice that \\(\\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal Z, \\mathcal S, \\mathcal R)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal S, \\mathcal R)}\\propto 1\\) since adding zero restrictions does not change the likelihood and only truncates uniform conditional prior \\(\\pi(\\mathbf{Q}|\\mathbf{B},\\mathbf{\\Sigma})\\).\n\\[\n\\begin{align*}\n\\frac{\\mathcal{NGN}(\\mathbf{A}_0,\\mathbf{A}_+|\\mathcal Z, \\mathcal S, \\mathcal R)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\n=&\\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal Z, \\mathcal S, \\mathcal R)v_{f_h}(\\mathbf{A}_0,\\mathbf{A}_+)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\\\\\n=&\\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal S, \\mathcal R)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})}\n\\frac{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal Z, \\mathcal S, \\mathcal R)}{\\mathcal{UNIW}(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}|\\mathcal S, \\mathcal R)}\\\\\n&\\times\n\\frac{v_{f_h}(\\mathbf{A}_0,\\mathbf{A}_+)}{v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\\\\\n\\propto&\\frac{1}{\\omega(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})}\\frac{v_{f_h}(\\mathbf{A}_0,\\mathbf{A}_+)}{v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\\\\\n\\propto&\\frac{1}{\\omega(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})}\\frac{|\\text{det}(\\mathbf{A}_0)|^{-(2N+K+1)}}{v_{(g\\circ f_h)|\\mathcal Z}(\\mathbf{A}_0,\\mathbf{A}_+)}\n\\end{align*}\n\\]\nThe following code calculates \\(\\omega(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q})\\) for the narrative restrictions\ndouble weight_narrative(\n    const int&                    T,\n    arma::mat                     sign_narrative,\n    const arma::cube&             irf\n) {\n  \n  const int M         = 1e+04;  // number of draws to approximate normal distribution\n  \n  double    n_success = 1.0e-15;\n  \n  cube      Z(irf.n_rows, sign_narrative.col(5).max() + 1, M, fill::randn);\n  \n  // change all starting period to the first period\n  // since we use the same M draws for all narrative restrictions\n  sign_narrative.col(4) = ones(sign_narrative.n_rows, 1);\n  \n  for (int m=0; m&lt;M; m++) {\n    if (match_sign_narrative(Z.slice(m), sign_narrative, irf)) {\n      n_success++;\n    }\n  }\n  return M / n_success;\n}\nArias, Rubio-Ramı́rez, and Waggoner (2018) provides a sufficient condition for the partial identification of the first \\(k\\) shocks: at least \\(N-j\\) zero restrictions and at least 1 sign restriction on the IRFs to the \\(j\\)-th shock for \\(1\\le j\\le k\\). At this stage, there is no theoretical result how to incorporate narrative restrictions in this sufficient condition. Generally, narrative restrictions are used to sharpen the inference (i.e. narrower highest density interval) and does not make the structural shocks exactly identified.\nIf given some narrative restrictions there is an uniquely identified \\(\\mathbf{Q}^*\\), step 3 of the importance sampling algorithm would never work, since the probability a randomly sampled \\(\\mathbf{Q}=\\mathbf{Q}^*\\) is \\(0\\). In the later empirical work, we show the algorithm can still work with narrative restrictions, therefore at least the narrative restrictions considered here are not binding. But, the advantage of narrative (and sign) restrictions is that they are less controversial and the result can be agreed upon by more researchers."
  },
  {
    "objectID": "index.html#interpretation",
    "href": "index.html#interpretation",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Interpretation",
    "text": "Interpretation\nTwo popular methods to interpret the SVAR model are impulse response function (IRF) and forecast error variance decomposition (FEVD) (Kilian and Lütkepohl 2017, Chap 4).\n\nIRF\nThe impulse response function (IRF) of the SVAR model is used to interpret the effect of the optimism shock on the endogenous variables. Specifically, we are interested in whether a positive optimism shock leads to a simultaneous boom in consumption and hours worked (as in the United States).\nMathematically, the response of the \\(i\\)-th variable to the \\(j\\)-th shock at horizon \\(k\\) is given by the element at row \\(i\\) columns \\(j\\) of \\(\\mathbf{\\Theta}_k\\), where \\(\\mathbf{\\Theta}_k\\) is defined recursively as\n\\[\\begin{aligned}&\\mathbf{\\Theta}_{0} = \\left(\\mathbf{A}_{0}^{-1}\\right)^{\\prime},\\quad\\mathbf{\\Theta}_{h} = \\sum_{l=1}^{h}\\bigl(\\mathbf{A}_{\\ell}\\mathbf{A}_{0}^{-1}\\bigr)^{\\prime}\\mathbf{\\Theta}_{h-\\ell},\\quad\\mathrm{} 1 \\leq h \\leq p,\\\\&\\mathbf{\\Theta}_{h} = \\sum_{\\ell=1}^{p}\\bigl(\\mathbf{A}_{\\ell}\\mathbf{A}_{0}^{-1}\\bigr)^{\\prime}\\mathbf{\\Theta}_{h-\\ell},\\quad\\mathrm{} p &lt; h &lt; \\infty.\\end{aligned}\\]\n\n\nFEVD\nThe forecast error variance decomposition (FEVD) is used to quantify the relative importance of the optimism shock in explaining the variability of a \\(h\\)-step ahead forecast of a particular variable. For example, we will examine the proportion of the variability of consumption and hours worked explained by the optimism shock.\nMathematically, the \\(i\\)-th variable’s forecast error variance decomposition of the \\(j\\)-th shock at horizon \\(h\\) is given by\n\\[\n\\text{FEVD}_j^i(h) = \\frac{\\text{MSFE}_{j}^{i}(h)}{\\sum_{n=1}^{N}\\text{MSFE}_{j}^{n}(h)}, \\quad \\text{MSFE}_{j}^{i}(h) = \\sum_{l=0}^{h-1} \\mathbf{\\Theta}_{ij,l}^{2}\n\\]"
  },
  {
    "objectID": "index.html#us-data",
    "href": "index.html#us-data",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "US data",
    "text": "US data\nFirst, we apply the package to the data from the United States, and replicate the results in Arias, Rubio-Ramı́rez, and Waggoner (2018).\n\nHistory\nHistorical values of the optimism shock is\nMost of the historical values of the optimism shock are not significantly different from 0, perhaps putting only one zero and one sign restriction is not enough to identify the optimism shock.\n\n\nIRF\nThe impulse response functions are\nwhich is very close to the ones in the original paper. Although consumption and hours worked have a boom in the median IRF, they are not significantly different from 0. Therefore, base on this identification strategy, the optimism shock does not drive business cycles in the US.\n\n\nFEVD\nThe forecast error variance decomposition of consumption and hours worked are\nShare of FEVD attributed to the optimism shock at horizon 40 (median 50%) and its 68% highest probability interval (16% and 84%) are\nwhich is very close to the ones in the original paper. As the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in the US."
  },
  {
    "objectID": "index.html#australian-data",
    "href": "index.html#australian-data",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Australian data",
    "text": "Australian data\nAll subsequent analysis are performed on the Australian data.\n\nHistory\nHistorical values of the optimism shock is\n\n\nIRF\nThe impulse response functions are\nComparing to the US, the optimism shock has a much smaller effect on consumption and hours worked in Australia, only stock prices has a significant effect in the short run. Therefore, base on the same identification strategy, the optimism shock does not drive business cycles in Australia as well.\n\n\nFEVD\nThe forecast error variance decomposition of consumption and hours worked are\nShare of FEVD attributed to the optimism shock at horizon 40 (median 50%) and its 68% highest probability interval (16% and 84%) are\nAs the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in Australia."
  },
  {
    "objectID": "index.html#extension-1",
    "href": "index.html#extension-1",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Extension",
    "text": "Extension\nNow we introduce an additional narrative restriction that\n\nthe optimism shock is negative when Covid-19 hits Australia in 2020 Q1.\n\nSince no one see the pandemic coming, and when it happens most people feel pessimistic due to many reasons. For example, being locked down in the house, losing jobs, and feeling uncertain about the future. An Australian national survey conducted in April 2020 (Fisher et al. 2020) finds 27.6% of people have clinically significant symptoms of depression, and 59.2% reported being more irritable. Therefore, it is reasonable to assume that the optimism shock is negative when Covid-19 hits Australia.\n\nHistory\nHistorical values of the optimism shock is\n\n\n\n\n\nWhere the vertical dashed line indicates the period 2020 Q1. Now all draws of the optimism shock are negative in 2020 Q1 due to the explicit narrative restriction, if we expand the highest density interval to 100% the interval will still not include zero. Comparing with the historical values of the optimism shock without the narrative restriction, here the highest density intervals are narrower but their overall shape are similar.\nOne interesting observation is that we see another two standard deviation pessimism shock around 2008, we did not impose any explicit narrative restriction here, but the model is likely picking up the effect of the global financial crisis.\n\n\nIRF\nThe impulse response functions are\n\n\n\n\n\nAustralian IRF with narrative restriction (median and 68% highest density interval)\n\n\n\n\nAlthough the median IRFs are slightly different from the previous case, the difference is not significant. After imposing the additional narrative restriction, the optimism shock still has no significant impact of the IRFs. Therefore, the conclusion that optimism shock does not drive business cycles in Australia is robust to the narrative restriction on Covid-19.\n\n\nFEVD\nShare of FEVD attributed to the optimism shock at horizon 40 (10 years) are\n\n\n\n\n\n\n16%\n50%\n84%\n\n\n\n\nproductivity\n1.56\n6.89\n24.56\n\n\nstock_prices\n4.63\n15.41\n39.38\n\n\nconsumption\n2.70\n8.90\n22.12\n\n\nreal_interest_rate\n10.38\n27.54\n49.22\n\n\nhours_worked\n4.13\n12.16\n24.86\n\n\n\n\n\nAs the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in Australia. This is similar the the previous case without the narrative restriction on Covid-19, and is another evidence that the optimism shock does not drive business cycles in Australia."
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nIntuitively, the PFA uses a loss function to find a rotation matrix \\(\\mathbf{Q}\\) that satisfies the zero restrictions and satisfies or close to satisfying the sign restrictions, thus it is not an exact solution. In comparison, the importance sampler algorithm is an exact solution satisfying all the restrictions.↩︎"
  },
  {
    "objectID": "index.html#simulation",
    "href": "index.html#simulation",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Simulation",
    "text": "Simulation\n\nReduced form\nTo test the validity of our code, we simulate 1,000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2.\nThen, we compute 1,000 posterior draws from a SVAR model with a constant term and one lag, using the default identification scheme: positive sign restrictions on the diagonal of \\(\\mathbf{A}_0\\).\nThe posterior mean of the \\(\\mathbf{B}\\) is\n\n\n\n\n\n\ny1\ny2\n\n\n\n\ny1_lag\n0.9885\n0.0052\n\n\ny2_lag\n0.0027\n0.9954\n\n\nconstant\n0.0589\n0.0822\n\n\n\n\n\nThe posterior mean of \\(\\mathbf{\\Sigma}\\) is\n\n\n\n\n\n\ny1\ny2\n\n\n\n\ny1\n0.9760\n0.0881\n\n\ny2\n0.0881\n1.0146\n\n\n\n\n\nThey are close to the true values of the simulated data.\n\n\nStructural form\nSuppose the true structural model is\n\\[\n\\begin{bmatrix}\n-1 & 1\\\\\n1 & 0\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\ny_{1,t}\\\\\ny_{2,t}\\\\\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-1 & 1\\\\\n1 & 0\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\ny_{1,t-1}\\\\\ny_{2,t-1}\\\\\n\\end{bmatrix}\n+\n\\begin{bmatrix}\n\\varepsilon_{1,t}\\\\\n\\varepsilon_{2,t}\\\\\n\\end{bmatrix},\n\\begin{bmatrix}\n\\varepsilon_{1,t}\\\\\n\\varepsilon_{2,t}\\\\\n\\end{bmatrix}\n\\sim\n\\mathcal{N}(\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix}\n,\n\\begin{bmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n\\end{bmatrix}\n)\n\\]\nequivalently, we can simulate 1,000 observations from the reduced-form\n\\[\n\\begin{bmatrix}\ny_{1,t}\\\\\ny_{2,t}\\\\\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1 & 0\\\\\n0 & 1\\\\\n\\end{bmatrix}\n\\begin{bmatrix}\ny_{1,t-1}\\\\\ny_{2,t-1}\\\\\n\\end{bmatrix}\n+\n\\begin{bmatrix}\nu_{1,t}\\\\\nu_{2,t}\\\\\n\\end{bmatrix},\n\\begin{bmatrix}\nu_{1,t}\\\\\nu_{2,t}\\\\\n\\end{bmatrix}\n\\sim\n\\mathcal{N}(\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix}\n,\n\\begin{bmatrix}\n1 & 1 \\\\\n1 & 2 \\\\\n\\end{bmatrix}\n)\n\\]\nPutting zero and sign restrictions on the inverse of the structural matrix\n\\[\n\\begin{bmatrix}\n-1 & 1\\\\\n1 & 0\\\\\n\\end{bmatrix}^{-1}\n=\n\\begin{bmatrix}\n0 & 1\\\\\n1 & 1\\\\\n\\end{bmatrix}\n\\Rightarrow\n\\begin{bmatrix}\n0 & +\\\\\n+ & +\\\\\n\\end{bmatrix}\n\\]\nPosterior mean of 1,000 draws of the structural matrix is\n\n\n        [,1]   [,2]\n[1,] -0.9614 1.0448\n[2,]  0.9614 0.0000"
  },
  {
    "objectID": "slides.html",
    "href": "slides.html",
    "title": "Optimism Shock",
    "section": "",
    "text": "In this research project, I…\n\nR package bsvarSIGNs\n\nhopefully on CRAN next semester!\n\nImplements Arias, Rubio-Ramı́rez, and Waggoner (2018)\nReplicates US data\nExtends to Australian data and more"
  },
  {
    "objectID": "slides.html#footnotes",
    "href": "slides.html#footnotes",
    "title": "Optimism Shock",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nArias, Rubio-Ramı́rez, and Waggoner (2018) and Antolı́n-Dı́az and Rubio-Ramı́rez (2018)↩︎"
  },
  {
    "objectID": "index.html#united-states",
    "href": "index.html#united-states",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "United States",
    "text": "United States\nFirst, we apply the package to the data from the United States, and replicate the results in Arias, Rubio-Ramı́rez, and Waggoner (2018).\n\nHistory\nHistorical values of the optimism shock is\n\n\n\n\n\nMost of the historical values of the optimism shock are not significantly different from 0, perhaps putting only one zero and one sign restriction is not enough to identify the optimism shock.\n\n\nIRF\nThe impulse response functions are\n\n\n\n\n\nUS IRF (median and 68% highest density interval)\n\n\n\n\nwhich is very close to the ones in the original paper. Although consumption and hours worked have a boom in the median IRF, they are not significantly different from 0. Therefore, base on this identification strategy, the optimism shock does not drive business cycles in the US.\n\n\nFEVD\nShare of FEVD attributed to the optimism shock at horizon 40 (median 50%) and its 68% highest probability interval (16% and 84%) are\n\n\n\n\n\n\n16%\n50%\n84%\n\n\n\n\nproductivity\n2.02\n7.77\n21.11\n\n\nstock_prices\n7.26\n30.52\n62.12\n\n\nconsumption\n2.72\n17.17\n52.31\n\n\nreal_interest_rate\n6.39\n17.21\n38.98\n\n\nhours_worked\n4.33\n17.88\n48.92\n\n\n\n\n\nwhich is very close to the ones in the original paper. As the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in the US."
  },
  {
    "objectID": "index.html#australia",
    "href": "index.html#australia",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Australia",
    "text": "Australia\nAll subsequent analysis are performed on the Australian data.\n\nHistory\nHistorical values of the optimism shock is\n\n\n\n\n\nWhere the vertical dashed line indicates the period 2020 Q1. Although we have not impose any restriction here, the optimism shock is still significantly negative in 2020 Q1 i.e. the 68% highest density interval does not include zero, this is likely due to the Covid-19 pandemic.\n\n\nIRF\nThe impulse response functions are\n\n\n\n\n\nAustralian IRF (median and 68% highest density interval)\n\n\n\n\nComparing to the US, the optimism shock has a much smaller effect on consumption and hours worked in Australia, only stock prices has a significant effect in the short run, other variables all have wide and symmetric IRFs around zero. Therefore, base on the same identification strategy, we conclude the optimism shock does not drive business cycles in Australia as well.\n\n\nFEVD\nShare of FEVD attributed to the optimism shock at horizon 40 (median 50%) and its 68% highest probability interval (16% and 84%) are\n\n\n\n\n\n\n16%\n50%\n84%\n\n\n\n\nproductivity\n1.33\n7.30\n25.56\n\n\nstock_prices\n3.63\n13.17\n34.95\n\n\nconsumption\n2.84\n9.23\n23.12\n\n\nreal_interest_rate\n10.48\n27.09\n47.85\n\n\nhours_worked\n4.11\n11.54\n26.33\n\n\n\n\n\nAs the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in Australia, which is a second evidence that the optimism shock does not drive business cycles in Australia."
  },
  {
    "objectID": "index.html#robustness",
    "href": "index.html#robustness",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Robustness",
    "text": "Robustness\nPreviously, we introduced three identification assumption on the optimism shock.\n\nIt has positive contemporaneous effect on stock prices.\nIt has no contemporaneous effect on productivity.\nIt is negative in 2020 Q1.\n\nNow we test several robustness checks to see if the results are sensitive to these assumptions."
  },
  {
    "objectID": "index.html#robustness-checks",
    "href": "index.html#robustness-checks",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Robustness checks",
    "text": "Robustness checks\nPreviously, we introduced three identification assumption on the optimism shock.\n\nIt has positive contemporaneous effect on stock prices.\nIt has no contemporaneous effect on productivity.\nIt is negative in 2020 Q1.\n\nNow we test several robustness checks to see if the results are sensitive to these assumptions."
  },
  {
    "objectID": "index.html#additional-narratives",
    "href": "index.html#additional-narratives",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Additional narratives",
    "text": "Additional narratives\nPreviously, we introduced three identification assumption on the optimism shock.\n\nIt has positive contemporaneous effect on stock prices.\nIt has no contemporaneous effect on productivity.\nIt is negative in 2020 Q1.\n\nThey give a insignificant result that says the optimism shock does not drive business cycles in Australia. Now we consider additional identification assumptions that may change this interpretation.\nTo be specific, we extend the periods that the optimism shock is negative to the whole year of 2020. The economic validity is much harder to justified here, but it is a good exercise to see how the results change with additional (narrative) restrictions.\n\n\n\n\n\nAustralian IRF with additional narrative restriction (median and 68% highest density interval)\n\n\n\n\nThe result become significant after imposing more narrative restrictions. Although these additional narrative restrictions are difficult to justified, they are still much less controversial than imposing more zero restrictions (see section Model-Algorithm-Extension). To get a similar significant result, one could definitely choose these narrative restrictions more carefully than what we did here. This shows our extension can be useful for researchers, since the original method cannot narrow down the highest density intervals without imposing controversial restrictions."
  },
  {
    "objectID": "index.html#extension-1-narrative-restriction",
    "href": "index.html#extension-1-narrative-restriction",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Extension 1: narrative restriction",
    "text": "Extension 1: narrative restriction\nNow we introduce an additional narrative restriction that\n\nthe optimism shock is negative when Covid-19 hits Australia in 2020 Q1.\n\nSince no one see the pandemic coming, and when it happens most people feel pessimistic due to many reasons. For example, being locked down in the house, losing jobs, and feeling uncertain about the future. An Australian national survey conducted in April 2020 (Fisher et al. 2020) finds 27.6% of people have clinically significant symptoms of depression, and 59.2% reported being more irritable. Therefore, it is reasonable to assume that the optimism shock is negative when Covid-19 hits Australia.\n\nHistory\nHistorical values of the optimism shock is\n\n\n\n\n\nWhere the vertical dashed line indicates the period 2020 Q1. Now all draws of the optimism shock are negative in 2020 Q1 due to the explicit narrative restriction, if we expand the highest density interval to 100% the interval will still not include zero. Comparing with the historical values of the optimism shock without the narrative restriction, here the highest density intervals are narrower but their overall shape are similar.\nOne interesting observation is that we see another two standard deviation pessimism shock around 2008, we did not impose any explicit narrative restriction here, but the model is likely picking up the effect of the global financial crisis.\n\n\nIRF\nThe impulse response functions are\n\n\n\n\n\nAustralian IRF with narrative restriction (median and 68% highest density interval)\n\n\n\n\nAlthough the median IRFs are slightly different from the previous case, the difference is not significant. After imposing the additional narrative restriction, the optimism shock still has no significant impact of the IRFs. Therefore, the conclusion that optimism shock does not drive business cycles in Australia is robust to the narrative restriction on Covid-19.\n\n\nFEVD\nShare of FEVD attributed to the optimism shock at horizon 40 (10 years) are\n\n\n\n\n\n\n16%\n50%\n84%\n\n\n\n\nproductivity\n1.56\n6.89\n24.56\n\n\nstock_prices\n4.63\n15.41\n39.38\n\n\nconsumption\n2.70\n8.90\n22.12\n\n\nreal_interest_rate\n10.38\n27.54\n49.22\n\n\nhours_worked\n4.13\n12.16\n24.86\n\n\n\n\n\nAs the median values are relatively small (&lt;20%), the optimism shock does not contribute significantly to the FEVD of consumption and hours worked in Australia. This is similar the the previous case without the narrative restriction on Covid-19, and is another evidence that the optimism shock does not drive business cycles in Australia."
  },
  {
    "objectID": "index.html#extension-2-hierachical-prior-lambda",
    "href": "index.html#extension-2-hierachical-prior-lambda",
    "title": "Sign and Zero Restrictions: Optimism Shock on the Australian Business Cycle",
    "section": "Extension 2: hierachical prior \\(\\lambda\\)",
    "text": "Extension 2: hierachical prior \\(\\lambda\\)\nPrevious results have been implicitly relied on the choice of the hyperparameter \\(\\lambda\\) in the Minnesota prior:\n\\[\n\\underline{\\mathbf{V}} = \\text{diag}\\left[\\lambda^2 * \\text{rep}(1,p)\\otimes\\psi \\quad 10^6 \\right]\n\\]\nwhere we set \\(\\lambda = 0.2\\) and \\(\\psi\\) as the residual variances from independent AR(1) models. Now we impose a Gamma hierachical prior on \\(\\lambda\\) such that it peaks at around 0.2, specifically with scale and shape parameters:\n\\[\n\\lambda \\sim \\Gamma\\left(\\frac{9 + \\sqrt{17}}{8}, \\frac{8}{5(1 + \\sqrt{17})}\\right)\n\\]\nGiannone, Lenza, and Primiceri (2015) proposed a Metropolis algorithm to sample a vector of hyperparameters \\(\\gamma=(\\mu,\\delta,\\lambda,\\psi)\\) where \\(\\mu\\) and \\(\\delta\\) are for dummy observation priors that will not be discussed here. A simplified version of their algorithm to sample \\(\\lambda\\) is as follows:\n\nInitialize \\(\\lambda\\) by maximizing its log posterior, store the numerical Hessian matrix (scalar) \\(W\\).\nSample \\(\\lambda^*\\sim\\mathcal{N}(\\lambda^{(s-1)},W)\\).\nAccept \\(\\lambda^{(s)}=\\lambda^*\\) with probability \\(\\alpha = \\min\\left\\{ 1, \\frac{p(\\lambda^*|\\mathbf{Y})}{p(\\lambda^{(s-1)}|\\mathbf{Y})} \\right\\}\\).\n\nGiven the resulting sample \\(\\left\\{ \\lambda^{(s)} \\right\\}\\), we can then proceed to sample \\(\\mathbf{B},\\mathbf{\\Sigma},\\mathbf{Q}\\) by first taking a uniform draw from \\(\\left\\{ \\lambda^{(s)} \\right\\}\\).\nThe following R code implements the above algorithm.\n\nniw_prior = function(Y,\n                     p,\n                     non_stationary,\n                     lambda = 0.2) {\n  T = nrow(Y)\n  N = ncol(Y)\n  K = 1 + N * p\n  \n  B           = matrix(0, K, N)\n  B[1:N, 1:N] = diag(non_stationary)\n  \n  sigma2                  = sapply(1:N, \\(i) summary(lm(Y[2:T, i] ~ Y[1:(T - 1), i]))$sigma^2)\n  V                       = matrix(0, K, K)\n  V[K, K]                 = 1e+6\n  V[1:(K - 1), 1:(K - 1)] = diag(lambda^2 * kronecker((1:p)^-2, sigma2^-1))\n  \n  S  = diag(sigma2)\n  nu = N + 2\n  \n  list(B = B, V = V, S = S, nu = nu)\n}\n\n\nlog_det = function(A) {\n  determinant(A, logarithm = TRUE)$modulus\n}\n\ndlambda = function(lambda, p, Y, X) {\n  \n  N     = ncol(Y)\n  T     = nrow(Y)\n  prior = niw_prior(Y, p, rep(1, N), lambda)\n  \n  b     = prior$B\n  Omega = prior$V\n  Psi   = prior$S\n  d     = prior$nu\n  \n  inv_Omega = solve(Omega)\n  Bhat      = solve(t(X) %*% X + inv_Omega) %*% (t(X) %*% Y + inv_Omega %*% b)\n  ehat      = Y - X %*% Bhat\n  \n  lprior    = dgamma(\n    lambda,\n    shape = (9 + sqrt(17)) / 8,\n    scale = 8 / (5 * (1 + sqrt(17))),\n    log = TRUE\n  )\n  \n  llike     = -N / 2 * log_det(Omega)\n  llike     = llike - N / 2 * log_det(t(X) %*% X + inv_Omega)\n  A         = Psi + t(ehat) %*% ehat + t(Bhat - b) %*% inv_Omega %*% (Bhat - b)\n  llike     = llike - (T + d) / 2 * log_det(A)\n  \n  return(lprior + llike)\n}\n\n\nsample_lambda = function(S, p, Y, X) {\n  init   = 0.2\n  result = optim(\n    init,\n    \\(lambda) {\n      nlogp = -dlambda(lambda, p, Y, X)\n      if (!is.finite(nlogp)) {\n        nlogp = 1e+6\n      }\n      return(nlogp)\n    },\n    method  = \"L-BFGS-B\",\n    lower = init / 100,\n    upper = init * 100,\n    hessian = TRUE,\n    # control = list(trace = 1, maxit = 1e4)\n  )\n  \n  lambda    = numeric(S)\n  lambda[1] = result$par\n  dlambda   = result$value\n  \n  c         = 1\n  W         = c * 1 / result$hessian\n  \n  for (s in 2:S) {\n    new_lambda  = rnorm(1, lambda[s - 1], sqrt(W))\n    new_dlambda = dlambda(new_lambda, p, Y, X)\n    \n    if (runif(1) &lt; exp(new_dlambda - dlambda)) {\n      lambda[s] = new_lambda\n      dlambda   = new_dlambda\n    } else {\n      lambda[s] = lambda[s - 1]\n    }\n  }\n  \n  return(lambda)\n}\n\n\nConvergence diagnostics\nWe sample 12,000 draws of \\(\\lambda\\) and discard the first 2,000 draws as burn-in. From the trace plot, we can see that the chain has converged to a stationary distribution.\n\n\n\n\n\nFrom the histogram, we can see that the posterior distribution of \\(\\lambda\\) is centered around to 0.13, which shows the default choice of 0.2 is reasonable. On the other hand, since 0.13 is smaller than 0.2, the hirechical prior suggests more shrinkage than the default choice.\n\n\n\n\n\n\n\nIRF\nThe impulse response functions are\n\n\n\n\n\nAustralian IRF with hierachical prior (median and 68% highest density interval)\n\n\n\n\nFor simplicity, we only report the IRF in this extension. As the IRF is very similar to the previous results, our interpretation remains the same. By imposing the hierarchical prior on \\(\\lambda\\), we let the data to choose the level of shrinkage and this shows the conclusion is robust to a more flexible prior."
  }
]